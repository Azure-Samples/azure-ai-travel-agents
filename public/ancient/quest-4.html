<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Halls of Polyglot Services - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/Azure-Samples/azure-ai-travel-agents" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Codex of Ancient Agents</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Halls of Polyglot Services</h1>
<hr>
<p>Deep within the labyrinthine Halls of Polyglot Services, you uncover chambers where the &quot;Ancient Agents&quot; once worked in harmony. Each chamber represents a distinct language, its walls inscribed with sacred scripts that encode the secrets of multi-lingual collaboration. Here, the Codex orchestrates tools written in Python, Java, and TypeScript, ensuring seamless communication through the ancient Model Context Protocol (MCP). As you explore, you begin to see how this polyglot architecture allowed the ancients to harness the strengths of diverse tools, creating a unified system of unparalleled wisdom.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>MCP Integration</strong>: How to use MCP to enable seamless communication between polyglot services.</li>
<li>üîç <strong>Tool Discovery</strong>: How tools are dynamically registered and invoked using MCP protocols.</li>
<li>‚ö° <strong>Polyglot Design</strong>: How multi-language services can work together in a cohesive architecture.</li>
<li>üí° <strong>Service-Oriented Architecture</strong>: How modularity enhances scalability and maintainability in distributed systems.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/itinerary-planning/src/mcp_server.py</code></a></h3>
<p>The Python-based Itinerary Planning tool demonstrates the use of FastMCP to provide hotel and flight suggestions. It uses Python&#39;s dataclasses and asynchronous tools to create a modular and extensible service that integrates seamlessly with the MCP ecosystem.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">suggest_hotels</code>: Generates hotel recommendations based on location and dates, with validation for ISO date formats.</li>
<li><code class="inline-code">suggest_flights</code>: Provides flight options, including direct and connecting flights, based on departure and return dates.</li>
<li><code class="inline-code">validate_iso_date</code>: Ensures date inputs conform to the ISO format, preventing invalid data from entering the system.</li>
<li><code class="inline-code">mcp.run</code>: Initializes the FastMCP server for handling requests.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-python">@mcp.tool()
async def suggest_hotels(
    location: Annotated[str, Field(description=&quot;Location (city or area) to search for hotels&quot;)],
    check_in: Annotated[str, Field(description=&quot;Check-in date in ISO format (YYYY-MM-DD)&quot;)],
    check_out: Annotated[str, Field(description=&quot;Check-out date in ISO format (YYYY-MM-DD)&quot;)],
) -&gt; HotelSuggestions:
    check_in_date = validate_iso_date(check_in, &quot;check_in&quot;)
    check_out_date = validate_iso_date(check_out, &quot;check_out&quot;)
    if check_out_date &lt;= check_in_date:
        raise ValueError(&quot;check_out date must be after check_in date&quot;)
    # Generate mock hotel data
    hotels = [Hotel(name=&quot;Luxury Suites&quot;, location=location, rating=4.5, price_per_night=300, amenities=[&quot;WiFi&quot;, &quot;Pool&quot;], available_rooms=5)]
    return HotelSuggestions(hotels=hotels)
</code></pre>
<ul>
<li>Validates input dates to ensure accuracy and reliability of hotel suggestions.</li>
<li>Uses Python&#39;s <code class="inline-code">dataclasses</code> to structure hotel data, promoting readability and maintainability.</li>
<li>Demonstrates how MCP tools can provide structured outputs for downstream agents.</li>
</ul>
<hr>
<pre><code class="language-python">@mcp.tool()
async def suggest_flights(
    from_location: Annotated[str, Field(description=&quot;Departure location&quot;)],
    to_location: Annotated[str, Field(description=&quot;Destination location&quot;)],
    departure_date: Annotated[str, Field(description=&quot;Departure date in ISO format&quot;)],
    return_date: Annotated[str, Field(description=&quot;Return date in ISO format&quot;)],
) -&gt; FlightSuggestions:
    dep_date = validate_iso_date(departure_date, &quot;departure_date&quot;)
    ret_date = validate_iso_date(return_date, &quot;return_date&quot;)
    if ret_date &lt;= dep_date:
        raise ValueError(&quot;return_date must be after departure_date&quot;)
    # Generate mock flight data
    flights = [Flight(flight_id=&quot;123&quot;, airline=&quot;SkyWings&quot;, price=199.99, is_direct=True, departure=departure_date, arrival=return_date)]
    return FlightSuggestions(departure_flights=flights, return_flights=flights)
</code></pre>
<ul>
<li>Implements flight suggestion logic with validation for departure and return dates.</li>
<li>Shows how to structure complex data like flight segments and connections using Python&#39;s type annotations.</li>
<li>Highlights the importance of error handling in asynchronous MCP tools.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java</code></a></h3>
<p>This Java-based MCP server leverages Spring Boot to provide destination recommendations. It demonstrates the use of annotations and dependency injection for integrating services.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">@SpringBootApplication</code>: Marks the main application class for Spring Boot initialization.</li>
<li><code class="inline-code">destinationTools</code>: Registers the <code class="inline-code">DestinationService</code> as an MCP tool provider.</li>
<li><code class="inline-code">main</code>: Bootstraps the Spring application and starts the MCP server.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-java">@SpringBootApplication
public class McpServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(McpServerApplication.class, args);
    }

    @Bean
    public ToolCallbackProvider destinationTools(DestinationService destinationService) {
        return MethodToolCallbackProvider.builder().toolObjects(destinationService).build();
    }
}
</code></pre>
<ul>
<li>Uses Spring Boot&#39;s <code class="inline-code">@SpringBootApplication</code> annotation for streamlined application setup.</li>
<li>Registers <code class="inline-code">DestinationService</code> as an MCP tool provider, enabling dynamic tool discovery.</li>
<li>Demonstrates Java&#39;s strong typing and dependency injection capabilities for creating modular services.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/echo-ping/src/server.ts</code></a></h3>
<p>The Echo Ping tool is a minimal TypeScript-based MCP server designed for testing and debugging. It highlights how MCP servers handle tool registration and request routing.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupServerRequestHandlers</code>: Configures MCP request handlers for listing and invoking tools.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L37" target="_blank" rel="noopener noreferrer"><code class="inline-code">handlePostRequest</code></a>: Processes incoming tool invocation requests and handles errors gracefully.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L137" target="_blank" rel="noopener noreferrer"><code class="inline-code">createRPCErrorResponse</code></a>: Generates standardized error responses for invalid requests.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">private setupServerRequestHandlers() {
    this.server.setRequestHandler(ListToolsRequestSchema, async () =&gt; ({
        tools: EchoTools,
    }));
    this.server.setRequestHandler(CallToolRequestSchema, async (request) =&gt; {
        const tool = EchoTools.find((t) =&gt; t.name === request.params.name);
        if (!tool) {
            return this.createRPCErrorResponse(`Tool ${request.params.name} not found.`);
        }
        return { content: `Executed tool ${tool.name}` };
    });
}
</code></pre>
<ul>
<li>Dynamically registers tools, enabling extensibility without modifying core server logic.</li>
<li>Implements error handling to ensure robust tool invocation.</li>
<li>Demonstrates the use of TypeScript for type-safe development in MCP servers.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Explore how <code class="inline-code">validate_iso_date</code> ensures consistent input validation in the Python server.</li>
<li>Study the <code class="inline-code">destinationTools</code> bean to understand how Spring Boot integrates MCP services.</li>
<li>Use the Echo Ping server as a starting point for creating new MCP tools in TypeScript.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><strong>Extend Hotel Tool</strong>: Add a new feature to the <code class="inline-code">suggest_hotels</code> tool that filters hotels by rating or price range. Test it by invoking the tool via MCP.</li>
<li><strong>Create a New Java Tool</strong>: Implement a new tool in the <code class="inline-code">DestinationService</code> that recommends destinations based on user-defined tags like &quot;adventure&quot; or &quot;relaxation&quot;. Register it in the <code class="inline-code">McpServerApplication</code>.</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the ancient Codex and its interconnected systems.</p>
<p>By the sacred flame of the Oracle&#39;s altar, thou hast triumphed in the Halls of Polyglot Services, carving thy name upon the tablets of wisdom‚Äîpress onward, for the stars yet hold 40% of thy destined glory! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>