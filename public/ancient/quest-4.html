<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quest 4: The Polyglot Shrines - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/Azure-Samples/azure-ai-travel-agents" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Pyramid of the Llama Oracle</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Polyglot Shrines</h1>
<hr>
<p>In the dense heart of the jungle, you find a series of Polyglot Shrines‚Äîeach dedicated to the Codexians&#39; mastery of diverse tongues and technologies. These shrines represent the interconnected wisdom of the ancient civilization, where each chamber houses tools written in different languages, yet working harmoniously through the mystical Model Context Protocol (MCP). Your task is to explore these interconnected shrines, decipher their inscriptions, and uncover how the Codexians achieved seamless orchestration across their polyglot system.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Shrine of Invocation</strong>: How do the tools written in Python, Java, and TypeScript interact with the MCP protocol to provide their services?</li>
<li>‚ö° <strong>Harmony of Languages</strong>: What mechanisms ensure the tools in different languages (e.g., <code class="inline-code">suggest_hotels</code>, <code class="inline-code">getDestinationsByActivity</code>) are discoverable and callable within the system?</li>
<li>üõ°Ô∏è <strong>Ritual of Validation</strong>: How is input validated and error handling implemented to ensure robust and reliable operation across the polyglot tools?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix"><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</a>:</span> Service for Destination Recommendations</h3>
<p>This file contains the <code class="inline-code">DestinationService</code> class, which provides travel recommendations based on activity type, budget, season, or multiple preferences. It uses annotations to expose methods as MCP tools, enabling dynamic discovery and invocation.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">echoMessage</code>: Echoes back the input message, demonstrating a simple tool implementation.</li>
<li><code class="inline-code">getDestinationsByActivity</code>: Recommends destinations based on activity type, validating inputs and returning predefined results.</li>
<li><code class="inline-code">getDestinationsByPreferences</code>: Combines multiple criteria (activity, budget, season, family-friendly) to generate recommendations.</li>
</ul>
<h3><span class="header-prefix"><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java" target="_blank" rel="noopener noreferrer">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java</a>:</span> MCP Server Initialization</h3>
<p>This file initializes the MCP server for the destination recommendation tool, setting up the tool callbacks and enabling tool discovery.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">main</code>: Entry point for the Spring Boot application, starting the MCP server.</li>
<li><code class="inline-code">destinationTools</code>: Registers the <code class="inline-code">DestinationService</code> as a source of MCP tools using <code class="inline-code">MethodToolCallbackProvider</code>.</li>
</ul>
<h3><span class="header-prefix"><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer">src/tools/echo-ping/src/server.ts</a>:</span> Echo MCP Server Implementation</h3>
<p>This file implements an MCP server in TypeScript, showcasing how tools are registered and how requests are handled via the MCP protocol.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupServerRequestHandlers</code>: Configures the server to handle tool listing and invocation requests.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L37" target="_blank" rel="noopener noreferrer"><code class="inline-code">handlePostRequest</code></a>: Processes incoming MCP requests, connecting the transport layer and invoking tools.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L137" target="_blank" rel="noopener noreferrer"><code class="inline-code">createRPCErrorResponse</code></a>: Constructs JSON-RPC error responses for invalid requests or unexpected errors.</li>
</ul>
<h3><span class="header-prefix"><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer">src/tools/itinerary-planning/src/mcp_server.py</a>:</span> Itinerary Planning MCP Server</h3>
<p>This Python file defines an MCP server for itinerary planning, providing tools to suggest hotels and flights based on user input.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">suggest_hotels</code>: Suggests hotels based on location and dates, with input validation and dynamic mock data generation.</li>
<li><code class="inline-code">suggest_flights</code>: Suggests flights based on departure and return details, ensuring return dates are after departure dates.</li>
<li><code class="inline-code">validate_iso_date</code>: Validates date inputs to ensure they conform to the ISO format.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</a></h3>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on preferred activity type&quot;)
public String getDestinationsByActivity(String activityType) {
    try {
        String activity = activityType.toUpperCase();
        if (!isValidActivityType(activity)) {
            return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;
        }
        return getDestinationsByPreference(activity, null, null, null);
    } catch (Exception e) {
        return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;
    }
}
</code></pre>
<ul>
<li>Validates the <code class="inline-code">activityType</code> input and ensures it matches predefined categories.</li>
<li>Uses helper methods to centralize validation logic, improving maintainability.</li>
<li>Returns predefined recommendations, ensuring quick responses.</li>
</ul>
<hr>
<h3><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java" target="_blank" rel="noopener noreferrer">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java</a></h3>
<pre><code class="language-java">@Bean
public ToolCallbackProvider destinationTools(DestinationService destinationService) {
    return MethodToolCallbackProvider.builder().toolObjects(destinationService).build();
}
</code></pre>
<ul>
<li>Registers the <code class="inline-code">DestinationService</code> methods as callable tools in the MCP server.</li>
<li>Uses <code class="inline-code">MethodToolCallbackProvider</code> to dynamically expose tool methods via annotations.</li>
<li>Enables seamless integration with the MCP protocol for tool discovery.</li>
</ul>
<hr>
<h3><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer">src/tools/echo-ping/src/server.ts</a></h3>
<pre><code class="language-typescript">private setupServerRequestHandlers() {
    this.server.setRequestHandler(ListToolsRequestSchema, async (_request) =&gt; {
        return {
            jsonrpc: JSON_RPC,
            tools: EchoTools,
        };
    });
    this.server.setRequestHandler(
        CallToolRequestSchema,
        async (request, _extra) =&gt; {
            const args = request.params.arguments;
            const toolName = request.params.name;
            const tool = EchoTools.find((tool) =&gt; tool.name === toolName);

            if (!tool) {
                return this.createRPCErrorResponse(`Tool ${toolName} not found.`);
            }
            try {
                const result = await tool.execute(args as any);
                return {
                    jsonrpc: JSON_RPC,
                    content: [
                        {
                            type: &#39;text&#39;,
                            text: `Tool ${toolName} executed with arguments ${JSON.stringify(args)}. Result: ${JSON.stringify(result)}`,
                        },
                    ],
                };
            } catch (error) {
                return this.createRPCErrorResponse(
                    `Error executing tool ${toolName}: ${error}`
                );
            }
        }
    );
}
</code></pre>
<ul>
<li>Handles tool listing and invocation requests, ensuring tools are discoverable and callable.</li>
<li>Validates tool existence and captures errors during execution, providing robust error handling.</li>
<li>Uses JSON-RPC to standardize communication between client and server.</li>
</ul>
<hr>
<h3><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer">src/tools/itinerary-planning/src/mcp_server.py</a></h3>
<pre><code class="language-python">def validate_iso_date(date_str: str, param_name: str) -&gt; datetime.date:
    iso_pattern = re.compile(r&quot;^\d{4}-\d{2}-\d{2}{{QUEST_CONTENT}}quot;)
    if not iso_pattern.match(date_str):
        raise ValueError(f&quot;{param_name} must be in ISO format (YYYY-MM-DD), got: {date_str}&quot;)
    try:
        return datetime.strptime(date_str, &quot;%Y-%m-%d&quot;).date()
    except ValueError as e:
        raise ValueError(f&quot;Invalid {param_name}: {e}&quot;)
</code></pre>
<ul>
<li>Validates that date strings conform to the ISO format, ensuring compatibility with other tools.</li>
<li>Raises descriptive errors for invalid inputs, improving user feedback.</li>
<li>Centralizes validation logic, reducing redundancy across tools.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li><strong>Input Validation</strong>: Pay close attention to how each tool validates its inputs to ensure reliable operation.</li>
<li><strong>Tool Discovery</strong>: Explore how tools are dynamically registered and exposed via the MCP protocol.</li>
<li><strong>Error Handling</strong>: Notice the mechanisms in place to handle invalid requests and unexpected errors gracefully.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries.</p>
<p>By the sacred light of the ancients, thou hast unlocked the tongues of the Polyglot Shrines, ascending ever closer to the pantheon of wisdom‚Äîpress onward, noble seeker! ‚ö°üíéüó∫Ô∏è</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>