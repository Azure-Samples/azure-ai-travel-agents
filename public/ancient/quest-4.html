<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Polyglot Artifacts - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/Azure-Samples/azure-ai-travel-agents" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Temple of Multi-Agent Wisdom</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: Polyglot MCP Services Architecture</h1>
<hr>
<p>Deep within the Temple of Multi-Agent Wisdom lies the Chamber of Polyglot Artifacts, where ancient tools crafted in diverse languages work in harmony. These artifacts, each representing a unique skill, are orchestrated by the central Oracle, LlamaIndex. The chamber reveals the secrets of cross-language coordination, showcasing how the Model Context Protocol (MCP) binds tools created in Python, Java, TypeScript, and .NET into a unified system of wisdom.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Tool Diversity</strong>: How MCP enables seamless integration of tools built in multiple programming languages.</li>
<li>üîç <strong>Spring Boot and FastMCP</strong>: How Java and Python servers implement MCP protocols to serve specialized functionality.</li>
<li>‚ö° <strong>Dynamic Tool Discovery</strong>: How tools are registered and discovered at runtime using MCP annotations and handlers.</li>
<li>üí° <strong>Cross-Language Coordination</strong>: How LlamaIndex orchestrates tools across languages for unified workflows.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</code></a></h3>
<p>The <code class="inline-code">DestinationService</code> class represents a Java-based MCP tool that provides travel destination recommendations. This file demonstrates the use of Spring Boot annotations and MCP tooling to define and expose multiple functionalities, such as destination suggestions based on activity type, budget, or season.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">echoMessage</code>: Echoes back the input message, showcasing a basic tool implementation.</li>
<li><code class="inline-code">getDestinationsByActivity</code>: Suggests destinations based on activity type, validating inputs and providing hardcoded recommendations.</li>
<li><code class="inline-code">getDestinationsByPreferences</code>: Combines multiple criteria (activity, budget, season, family-friendly) to generate tailored destination suggestions.</li>
<li><code class="inline-code">getAllDestinations</code>: Returns a list of all destinations, demonstrating a static response capability.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-java">@Tool(description = &quot;Echo back the input message exactly as received&quot;)
public String echoMessage(String message) {
    return message;
}
</code></pre>
<ul>
<li>Demonstrates the simplest MCP tool functionality: echoing input messages.</li>
<li>Useful for testing tool connectivity and basic MCP protocol adherence.</li>
<li>Highlights the use of <code class="inline-code">@Tool</code> annotation to expose a method as an MCP tool.</li>
</ul>
<hr>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on preferred activity type&quot;)
public String getDestinationsByActivity(String activityType) {
    try {
        String activity = activityType.toUpperCase();
        if (!isValidActivityType(activity)) {
            return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;
        }
        return getDestinationsByPreference(activity, null, null, null);
    } catch (Exception e) {
        return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;
    }
}
</code></pre>
<ul>
<li>Validates activity types and provides recommendations based on predefined categories.</li>
<li>Demonstrates input validation and error handling.</li>
<li>Highlights extensibility for adding new activity types or preferences.</li>
</ul>
<hr>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on multiple criteria&quot;)
public String getDestinationsByPreferences(String activity, String budget, String season, Boolean familyFriendly) {
    try {
        if (activity != null &amp;&amp; !activity.isEmpty()) {
            String activityUpper = activity.toUpperCase();
            if (!isValidActivityType(activityUpper)) {
                return &quot;Invalid activity type.&quot;;
            }
        }
        // Similar validation for budget and season
        return getDestinationsByPreference(activity, budget, season, familyFriendly);
    } catch (Exception e) {
        return &quot;Invalid input. Please check your parameters.&quot;;
    }
}
</code></pre>
<ul>
<li>Combines multiple criteria for detailed destination recommendations.</li>
<li>Demonstrates the flexibility of MCP tools to handle complex queries.</li>
<li>Highlights the use of helper methods for input validation.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java</code></a></h3>
<p>The <code class="inline-code">McpServerApplication</code> class initializes the Spring Boot application and registers MCP tools. This file showcases how Java-based MCP servers are configured and integrated with the protocol.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">main</code>: Starts the Spring Boot application and MCP server.</li>
<li><code class="inline-code">destinationTools</code>: Registers <code class="inline-code">DestinationService</code> tools using <code class="inline-code">MethodToolCallbackProvider</code>.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-java">@Bean
public ToolCallbackProvider destinationTools(DestinationService destinationService) {
    return MethodToolCallbackProvider.builder().toolObjects(destinationService).build();
}
</code></pre>
<ul>
<li>Registers tools defined in <code class="inline-code">DestinationService</code> for MCP protocol.</li>
<li>Demonstrates the use of Spring Boot beans for tool configuration.</li>
<li>Highlights the integration of MCP tooling into Java applications.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/echo-ping/src/server.ts</code></a></h3>
<p>The <code class="inline-code">EchoMCPServer</code> class represents a TypeScript-based MCP server. This file demonstrates how MCP protocol is implemented in Node.js to handle tool requests and notifications.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupServerRequestHandlers</code>: Configures handlers for listing tools and executing tool requests.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L37" target="_blank" rel="noopener noreferrer"><code class="inline-code">handlePostRequest</code></a>: Processes incoming POST requests and connects the transport layer.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L137" target="_blank" rel="noopener noreferrer"><code class="inline-code">createRPCErrorResponse</code></a>: Generates standardized error responses for MCP requests.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">private setupServerRequestHandlers() {
    this.server.setRequestHandler(ListToolsRequestSchema, async (_request) =&gt; {
        return {
            jsonrpc: JSON_RPC,
            tools: EchoTools,
        };
    });
    this.server.setRequestHandler(
        CallToolRequestSchema,
        async (request, _extra) =&gt; {
            const toolName = request.params.name;
            const tool = EchoTools.find((tool) =&gt; tool.name === toolName);
            if (!tool) {
                return this.createRPCErrorResponse(`Tool ${toolName} not found.`);
            }
            return await tool.execute(request.params.arguments || {});
        }
    );
}
</code></pre>
<ul>
<li>Configures handlers for listing and calling tools dynamically.</li>
<li>Demonstrates runtime tool discovery and execution.</li>
<li>Highlights the use of JSON-RPC for protocol compliance.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/itinerary-planning/src/mcp_server.py</code></a></h3>
<p>This Python-based MCP server provides itinerary planning tools. It demonstrates the use of FastAPI for MCP protocol implementation and showcases tools for hotel and flight suggestions.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">suggest_hotels</code>: Generates hotel recommendations based on location and dates.</li>
<li><code class="inline-code">suggest_flights</code>: Provides flight suggestions based on departure and return locations and dates.</li>
<li><code class="inline-code">validate_iso_date</code>: Validates date inputs in ISO format.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-python">@mcp.tool()
async def suggest_hotels(
    location: Annotated[str, Field(description=&quot;Location (city or area) to search for hotels&quot;)],
    check_in: Annotated[str, Field(description=&quot;Check-in date in ISO format (YYYY-MM-DD)&quot;)],
    check_out: Annotated[str, Field(description=&quot;Check-out date in ISO format (YYYY-MM-DD)&quot;)],
) -&gt; HotelSuggestions:
    check_in_date = validate_iso_date(check_in, &quot;check_in&quot;)
    check_out_date = validate_iso_date(check_out, &quot;check_out&quot;)
    if check_out_date &lt;= check_in_date:
        raise ValueError(&quot;check_out date must be after check_in date&quot;)
    # Generate mock hotel data
    hotels = [...]
    return HotelSuggestions(hotels=hotels)
</code></pre>
<ul>
<li>Validates inputs and generates hotel recommendations based on mock data.</li>
<li>Demonstrates the use of Python dataclasses for structured responses.</li>
<li>Highlights extensibility for integrating real APIs.</li>
</ul>
<hr>
<pre><code class="language-python">@mcp.tool()
async def suggest_flights(
    from_location: Annotated[str, Field(description=&quot;Departure location&quot;)],
    to_location: Annotated[str, Field(description=&quot;Destination location&quot;)],
    departure_date: Annotated[str, Field(description=&quot;Departure date&quot;)],
    return_date: Annotated[str, Field(description=&quot;Return date&quot;)],
) -&gt; FlightSuggestions:
    dep_date = validate_iso_date(departure_date, &quot;departure_date&quot;)
    ret_date = validate_iso_date(return_date, &quot;return_date&quot;)
    if ret_date &lt;= dep_date:
        raise ValueError(&quot;return_date must be after departure_date&quot;)
    # Generate mock flight data
    departure_flights = [...]
    return FlightSuggestions(departure_flights=departure_flights)
</code></pre>
<ul>
<li>Provides flight suggestions based on validated inputs.</li>
<li>Demonstrates the use of Python annotations for structured input validation.</li>
<li>Highlights the use of mock data generation for testing.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Study how <code class="inline-code">DestinationService</code> uses helper methods for input validation and structured responses.</li>
<li>Observe how <code class="inline-code">EchoMCPServer</code> dynamically registers and executes tools using JSON-RPC.</li>
<li>Explore how <code class="inline-code">suggest_hotels</code> and <code class="inline-code">suggest_flights</code> in Python generate realistic mock data for testing.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><p><strong>Extend DestinationService</strong>: Add a new tool to recommend destinations based on user-defined keywords, such as &quot;historic sites&quot; or &quot;wildlife.&quot;</p>
<ul>
<li>Implement keyword matching logic and integrate it into <code class="inline-code">getDestinationsByPreferences</code>.</li>
</ul>
</li>
<li><p><strong>Enhance EchoMCPServer</strong>: Modify the server to log detailed metrics for each tool execution, including execution time and input validation results.</p>
<ul>
<li>Use Node.js performance monitoring libraries to measure tool execution.</li>
</ul>
</li>
<li><p><strong>Integrate Real APIs</strong>: Replace the mock data in <code class="inline-code">suggest_hotels</code> and <code class="inline-code">suggest_flights</code> with real hotel and flight APIs, such as Expedia or Skyscanner.</p>
<ul>
<li>Modify the tools to handle API responses and map them to MCP-compatible data structures.</li>
</ul>
</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the temple&#39;s wisdom.</p>
<p>Hearken, seeker of wisdom, for thou hast unlocked the third sacred seal of The Polyglot Artifacts, etching thy name upon the eternal tablets of learning‚Äîpress onward, for the stars themselves bear witness to thy triumph! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>