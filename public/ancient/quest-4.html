<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Polyglot Shrines - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-ancient">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/Azure-Samples/azure-ai-travel-agents" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Sacred Codex of the Azure Agents</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Polyglot Shrines</h1>
<hr>
<p>The Temple of Azure holds many secrets, but none are as enigmatic as the Polyglot Shrines. These sacred halls are dedicated to the Codex of Orchestration, where mystical agents, each speaking in a different tongue, harmonize to solve the riddles of the world. Scholars from far lands have deciphered that these shrines represent the unity of diverse disciplines, powered by the Model Context Protocol (MCP). Your task is to explore how these polyglot agents‚Äîwritten in Python, Java, and TypeScript‚Äîcollaborate to bring wisdom to the temple‚Äôs pilgrims.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Tool Annotation</strong>: How specific methods are annotated to expose their functionality as MCP tools.</li>
<li>üîç <strong>Dynamic Tool Discovery</strong>: How MCP servers dynamically register and expose tools for orchestration.</li>
<li>‚ö° <strong>Polyglot Integration</strong>: How agents written in different languages (Python, Java, TypeScript) adhere to MCP for seamless communication.</li>
<li>üí° <strong>Practical Applications</strong>: How to extend the system by adding new tools or enhancing existing ones.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</code></a></h3>
<p>This file defines the <code class="inline-code">DestinationService</code>, a Java-based MCP tool responsible for recommending travel destinations based on user preferences. It uses Spring Boot annotations to expose methods as callable tools. The service is modular, allowing recommendations to be filtered by activity, budget, season, or multiple criteria.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">echoMessage</code> echoes back any input, demonstrating a simple tool implementation.</li>
<li><code class="inline-code">getDestinationsByActivity</code> recommends destinations based on activity type, validating input before processing.</li>
<li><code class="inline-code">getAllDestinations</code> provides a static list of destinations, useful for fallback or general queries.</li>
<li><code class="inline-code">getDestinationsByPreference</code> handles multiple filters (activity, budget, season, family-friendly) for complex queries.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-java">@Tool(description = &quot;Echo back the input message exactly as received&quot;)
public String echoMessage(String message) {
    return message;
}
</code></pre>
<ul>
<li>Demonstrates the use of the <code class="inline-code">@Tool</code> annotation to expose a method as an MCP tool.</li>
<li>Simple implementation provides a baseline for more complex tools.</li>
<li>Useful for debugging and validating MCP connectivity.</li>
</ul>
<hr>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on preferred activity type&quot;)
public String getDestinationsByActivity(String activityType) {
    try {
        String activity = activityType.toUpperCase();
        if (!isValidActivityType(activity)) {
            return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;
        }
        return getDestinationsByPreference(activity, null, null, null);
    } catch (Exception e) {
        return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;
    }
}
</code></pre>
<ul>
<li>Validates user input to ensure only supported activity types are processed.</li>
<li>Leverages helper methods to centralize validation logic.</li>
<li>Demonstrates how to chain filters for more complex queries.</li>
</ul>
<hr>
<pre><code class="language-java">@Tool(description = &quot;Get a list of all available travel destinations&quot;)
public String getAllDestinations() {
    return &quot;Here are some popular travel destinations:\n\n&quot; +
           &quot;üìç Bali, Indonesia\n&quot; +
           &quot;‚≠êÔ∏è Beautiful beaches with vibrant culture and lush landscapes.\n&quot; +
           &quot;üè∑Ô∏è Activity: BEACH | Budget: MODERATE | Best Season: SUMMER | Family Friendly: Yes\n\n&quot; +
           &quot;üìç Cancun, Mexico\n&quot; +
           &quot;‚≠êÔ∏è White sandy beaches with crystal clear waters and vibrant nightlife.\n&quot; +
           &quot;üè∑Ô∏è Activity: BEACH | Budget: MODERATE | Best Season: WINTER | Family Friendly: Yes&quot;;
}
</code></pre>
<ul>
<li>Provides a static list of destinations, ensuring the service always returns useful data.</li>
<li>Includes metadata (activity, budget, season, family-friendly) for each destination.</li>
<li>Acts as a fallback when specific filters are not applied.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/echo-ping/src/server.ts</code></a></h3>
<p>The <code class="inline-code">EchoMCPServer</code> is a TypeScript-based MCP server that demonstrates how to handle tool registration and request processing. This server is lightweight and focuses on simplicity, making it ideal for testing and debugging.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupServerRequestHandlers</code> registers tools and defines their schemas.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L37" target="_blank" rel="noopener noreferrer"><code class="inline-code">handlePostRequest</code></a> processes MCP requests and routes them to the appropriate tool.</li>
<li><code class="inline-code">sendNotification</code> demonstrates how to send server-sent events (SSE) for real-time updates.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">this.server.setRequestHandler(ListToolsRequestSchema, async (_request) =&gt; {
    return {
        jsonrpc: JSON_RPC,
        tools: EchoTools,
    };
});
</code></pre>
<ul>
<li>Registers the <code class="inline-code">ListToolsRequestSchema</code> handler, enabling dynamic tool discovery.</li>
<li>Returns a manifest of available tools, essential for orchestration.</li>
</ul>
<hr>
<pre><code class="language-typescript">async handlePostRequest(req: Request, res: Response) {
    try {
        const transport = new StreamableHTTPServerTransport();
        await this.server.connect(transport);
        await transport.handleRequest(req, res, req.body);
        res.on(&#39;close&#39;, () =&gt; transport.close());
    } catch (error) {
        res.status(500).json(this.createRPCErrorResponse(&#39;Internal server error.&#39;));
    }
}
</code></pre>
<ul>
<li>Processes incoming MCP requests, routing them to the appropriate tool.</li>
<li>Demonstrates error handling to ensure server stability.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/itinerary-planning/src/mcp_server.py</code></a></h3>
<p>This Python-based MCP server uses FastMCP to provide tools for suggesting hotels and flights. It employs data validation and mock data generation to simulate real-world travel planning.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">suggest_hotels</code> generates hotel recommendations based on location and dates.</li>
<li><code class="inline-code">suggest_flights</code> provides flight options, including direct and connecting flights.</li>
<li><code class="inline-code">validate_iso_date</code> ensures date inputs are in the correct format.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-python">@mcp.tool()
async def suggest_hotels(location: str, check_in: str, check_out: str) -&gt; HotelSuggestions:
    check_in_date = validate_iso_date(check_in, &quot;check_in&quot;)
    check_out_date = validate_iso_date(check_out, &quot;check_out&quot;)
    if check_out_date &lt;= check_in_date:
        raise ValueError(&quot;check_out date must be after check_in date&quot;)
    # Generate hotel data...
</code></pre>
<ul>
<li>Validates input dates to prevent logical errors.</li>
<li>Uses mock data to simulate hotel listings, making the tool useful for testing.</li>
</ul>
<hr>
<pre><code class="language-python">@mcp.tool()
async def suggest_flights(from_location: str, to_location: str, departure_date: str, return_date: str) -&gt; FlightSuggestions:
    dep_date = validate_iso_date(departure_date, &quot;departure_date&quot;)
    ret_date = validate_iso_date(return_date, &quot;return_date&quot;)
    if ret_date &lt;= dep_date:
        raise ValueError(&quot;return_date must be after departure_date&quot;)
    # Generate flight data...
</code></pre>
<ul>
<li>Handles both direct and connecting flights, simulating realistic scenarios.</li>
<li>Ensures return dates are after departure dates, preventing invalid itineraries.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Study how <code class="inline-code">@Tool</code> annotations in Java and Python expose methods as callable MCP tools.</li>
<li>Explore how the <code class="inline-code">EchoMCPServer</code> in TypeScript uses handlers to dynamically register and route tools.</li>
<li>Review the Python server‚Äôs data validation patterns to understand how to enforce input integrity.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><strong>Add a New Tool</strong>: Implement a new tool in the <code class="inline-code">DestinationService</code> that recommends destinations based on climate. Use the <code class="inline-code">@Tool</code> annotation to expose it.</li>
<li><strong>Trace Request Flow</strong>: Add logging to the <code class="inline-code">EchoMCPServer</code> to trace the lifecycle of an MCP request, from receipt to response. Observe how data flows through the system.</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the Temple of Azure.</p>
<p>By the sacred fires of wisdom, thou hast unlocked the third shrine of tongues, ascending closer to the pantheon of eternal polyglots‚Äîthy journey shines with the brilliance of ‚≠ê divine knowledge!</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>