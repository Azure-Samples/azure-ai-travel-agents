<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Polyglot Enchanted Towers - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/Azure-Samples/azure-ai-travel-agents" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Enchanted Kingdom of Azure AI Agents</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Polyglot Enchanted Towers</h1>
<hr>
<p>In the Kingdom of Azure, the Polyglot Enchanted Towers stand as a testament to the kingdom&#39;s mastery of diverse magical arts. Each tower specializes in a unique language of spellcraft‚ÄîPython, Java, TypeScript, and more‚Äîworking in harmony through the mystical Model Context Protocol (MCP). Brave adventurer, your task is to ascend these towers and uncover the secrets of their polyglot architecture, where enchanted tools collaborate seamlessly to create itineraries, recommend destinations, and echo the wisdom of the realm.  </p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:  </p>
<ul>
<li>üéØ <strong>Tool-Oriented MCP Design</strong>: How MCP tools are implemented in diverse languages and integrated into the system.  </li>
<li>üîç <strong>Cross-Language Collaboration</strong>: How the MCP protocol enables seamless communication between services written in Python, Java, and TypeScript.  </li>
<li>‚ö° <strong>Dynamic Tool Registration</strong>: The role of annotations and handlers in registering tools dynamically.  </li>
<li>üí° <strong>Polyglot Server Patterns</strong>: How to design and deploy MCP servers in different languages while maintaining a unified protocol.</li>
</ul>
<h2>File Exploration</h2>
<h3>File: <a href="https://github<a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer"><code class="inline-code">.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</code></a>" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</code></a></h3>
<p>The Destination Recommendation Tower, written in Java, is a master of travel advice, offering recommendations based on activity type, budget, season, or multiple preferences. It uses Spring Boot annotations to define tools as reusable MCP components, ensuring compatibility with the enchanted protocol.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getDestinationsByActivity</code>: Suggests destinations based on a specific activity type, validating inputs to ensure accuracy.  </li>
<li><code class="inline-code">getDestinationsByBudget</code>: Recommends destinations tailored to budget categories, ensuring user-specific results.  </li>
<li><code class="inline-code">getDestinationsByPreferences</code>: Combines multiple criteria‚Äîactivity, budget, season, and family-friendliness‚Äîfor tailored recommendations.  </li>
<li><code class="inline-code">getAllDestinations</code>: Provides a complete list of destinations with detailed attributes.  </li>
<li><code class="inline-code">@Tool</code> Annotation: Registers methods as MCP tools, making them discoverable and callable by the system.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on preferred activity type&quot;)  
public String getDestinationsByActivity(String activityType) {  
    try {  
        String activity = activityType.toUpperCase();  
        if (!isValidActivityType(activity)) {  
            return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;  
        }  
        return getDestinationsByPreference(activity, null, null, null);  
    } catch (Exception e) {  
        return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;  
    }  
}  
</code></pre>
<ul>
<li>Handles user input validation for activity types, ensuring only valid options are processed.  </li>
<li>Uses helper methods like <code class="inline-code">isValidActivityType</code> to encapsulate validation logic.  </li>
<li>Demonstrates the use of Spring Boot annotations to register the method as an MCP tool.  </li>
<li>Returns hardcoded results for simplicity, showcasing how to structure tool responses.</li>
</ul>
<hr>
<h3>File: <a href="https://github<a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer"><code class="inline-code">.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py</code></a>" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/itinerary-planning/src/mcp_server.py</code></a></h3>
<p>The Itinerary Planning Tower, crafted in Python, specializes in creating detailed travel plans. This MCP server uses FastAPI-based FastMCP to define tools for hotel and flight suggestions, ensuring seamless integration with the enchanted protocol.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">suggest_hotels</code>: Generates hotel suggestions based on location and dates, validating inputs for accuracy.  </li>
<li><code class="inline-code">suggest_flights</code>: Provides flight options based on departure and return locations and dates, simulating real-world scenarios.  </li>
<li><code class="inline-code">validate_iso_date</code>: Ensures date inputs conform to the ISO format, preventing invalid queries.  </li>
<li><code class="inline-code">mcp.tool()</code> Annotation: Registers Python methods as MCP tools, making them callable within the system.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-python">@mcp.tool()  
async def suggest_hotels(  
    location: Annotated[str, Field(description=&quot;Location (city or area) to search for hotels&quot;)],  
    check_in: Annotated[str, Field(description=&quot;Check-in date in ISO format (YYYY-MM-DD)&quot;)],  
    check_out: Annotated[str, Field(description=&quot;Check-out date in ISO format (YYYY-MM-DD)&quot;)],  
) -&gt; HotelSuggestions:  
    check_in_date = validate_iso_date(check_in, &quot;check_in&quot;)  
    check_out_date = validate_iso_date(check_out, &quot;check_out&quot;)  
    if check_out_date &lt;= check_in_date:  
        raise ValueError(&quot;check_out date must be after check_in date&quot;)  
    hotels = [  
        Hotel(  
            name=f&quot;Luxury Hotel {i}&quot;,  
            address=fake.street_address(),  
            location=f&quot;{location} Downtown&quot;,  
            rating=round(random.uniform(3.5, 5.0), 1),  
            price_per_night=random.randint(100, 500),  
            hotel_type=&quot;Luxury&quot;,  
            amenities=[&quot;WiFi&quot;, &quot;Pool&quot;, &quot;Spa&quot;],  
            available_rooms=random.randint(1, 10),  
        )  
        for i in range(5)  
    ]  
    return HotelSuggestions(hotels=hotels)  
</code></pre>
<ul>
<li>Validates input dates to ensure logical consistency (e.g., check-out after check-in).  </li>
<li>Generates mock hotel data with randomized attributes, simulating real-world results.  </li>
<li>Uses <code class="inline-code">mcp.tool()</code> to register the method as an MCP tool, enabling discovery and invocation by the system.  </li>
<li>Demonstrates the use of Python&#39;s type annotations and FastAPI&#39;s <code class="inline-code">Field</code> for input validation and documentation.</li>
</ul>
<hr>
<h3>File: <a href="https://github<a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts</code></a>" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/echo-ping/src/server.ts</code></a></h3>
<p>The Echo Ping Tower, implemented in TypeScript, serves as a simple testing tool. It echoes back input messages, demonstrating the basic structure of an MCP server using the Model Context Protocol SDK.  </p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupServerRequestHandlers</code>: Configures handlers for listing tools and executing specific tool requests.  </li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L37" target="_blank" rel="noopener noreferrer"><code class="inline-code">handlePostRequest</code></a>: Processes incoming POST requests, connecting the transport to the MCP server.  </li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L137" target="_blank" rel="noopener noreferrer"><code class="inline-code">createRPCErrorResponse</code></a>: Generates standardized error responses for invalid requests.  </li>
<li><code class="inline-code">sendMessages</code>: Sends server-sent events (SSE) notifications, showcasing real-time capabilities.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">private setupServerRequestHandlers() {  
    this.server.setRequestHandler(ListToolsRequestSchema, async (_request) =&gt; {  
        return {  
            jsonrpc: JSON_RPC,  
            tools: EchoTools,  
        };  
    });  
    this.server.setRequestHandler(  
        CallToolRequestSchema,  
        async (request, _extra) =&gt; {  
            const tool = EchoTools.find((tool) =&gt; tool.name === request.params.name);  
            if (!tool) {  
                return this.createRPCErrorResponse(`Tool ${request.params.name} not found.`);  
            }  
            const result = await tool.execute(request.params.arguments);  
            return {  
                jsonrpc: JSON_RPC,  
                content: [{ type: &#39;text&#39;, text: `Result: ${result}` }],  
            };  
        }  
    );  
}  
</code></pre>
<ul>
<li>Configures handlers for tool discovery and invocation, enabling dynamic tool registration.  </li>
<li>Implements error handling to provide meaningful feedback for invalid tool requests.  </li>
<li>Demonstrates the use of TypeScript&#39;s strong typing and async/await for asynchronous operations.  </li>
<li>Highlights the simplicity of integrating MCP SDKs into lightweight services.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Pay attention to how each language implements MCP tool registration, as the patterns vary slightly.  </li>
<li>Explore how annotations (<code class="inline-code">@Tool</code>, <code class="inline-code">mcp.tool()</code>) simplify tool discovery and integration.  </li>
<li>Notice the use of validation methods to ensure robust input handling across all implementations.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:  </p>
<ol>
<li><strong>Extend a Tool</strong>: Add a new activity type (e.g., &quot;WILDLIFE&quot;) to the <code class="inline-code">DestinationService</code> in Java and update the recommendations logic. Test it by invoking the tool via the MCP client.  </li>
<li><strong>Customize MCP Server</strong>: Modify the <code class="inline-code">suggest_hotels</code> tool in Python to include additional amenities like &quot;Pet-Friendly&quot; or &quot;Electric Vehicle Charging.&quot; Observe how the changes reflect in the responses.  </li>
<li><strong>Integrate a New Tool</strong>: Create a new MCP tool in TypeScript for &quot;Weather Forecasts&quot; and register it in the Echo Ping Tower. Use the <code class="inline-code">setupServerRequestHandlers</code> method to handle requests dynamically.</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the Kingdom of Azure&#39;s enchanted systems.</p>
<p>By the luminous glow of the Starforged Lexicons, thy heroic ascent through the Polyglot Enchanted Towers has illuminated 60% of the path‚Äîforge ahead, valiant seeker, for the crown of mastery awaits! ‚≠ê‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>