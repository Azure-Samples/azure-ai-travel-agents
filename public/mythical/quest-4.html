<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polyglot Realm of Agents - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/Azure-Samples/azure-ai-travel-agents" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Enchanted Kingdom of Multi-Agent Harmony</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Adventure</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Polyglot Symphony of MCP Services</h1>
<hr>
<p>In the Polyglot Realm of Agents, the Mage LlamaIndex.TS has summoned a symphony of multilingual magic to aid travelers. Each enchanted scroll, written in Python, Java, or TypeScript, weaves its unique spell to handle complex tasks like suggesting itineraries, recommending destinations, and echoing queries. The harmony of these diverse spells is maintained by the Model Context Protocol (MCP), ensuring seamless communication across the kingdom&#39;s varied tongues. But to wield this power, one must delve into the heart of these spells and learn their secrets.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Tool Registration</strong>: How MCP tools are registered and exposed for dynamic discovery across polyglot services.</li>
<li>üîç <strong>Cross-Language Integration</strong>: How MCP enables seamless communication between services written in Python, Java, and TypeScript.</li>
<li>‚ö° <strong>Service-Oriented Design</strong>: The benefits of modular, language-agnostic microservices in a multi-agent system.</li>
<li>üí° <strong>Dynamic Tool Discovery</strong>: How agents dynamically list and invoke tools at runtime using MCP.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/itinerary-planning/src/mcp_server.py</code></a></h3>
<p>The Python-based Itinerary Planning MCP server uses <code class="inline-code">FastMCP</code> to expose tools for suggesting hotels and flights. It demonstrates how to validate input, generate mock data, and structure responses for seamless integration with the MCP ecosystem.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">suggest_hotels</code>: Suggests hotels based on location and dates, validating input and generating mock data.</li>
<li><code class="inline-code">suggest_flights</code>: Suggests flights based on departure and return locations and dates, including mock data for direct and connecting flights.</li>
<li><code class="inline-code">validate_iso_date</code>: Validates ISO date strings to ensure proper input formatting.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-python">@mcp.tool()
async def suggest_hotels(
    location: Annotated[str, Field(description=&quot;Location (city or area) to search for hotels&quot;)],
    check_in: Annotated[str, Field(description=&quot;Check-in date in ISO format (YYYY-MM-DD)&quot;)],
    check_out: Annotated[str, Field(description=&quot;Check-out date in ISO format (YYYY-MM-DD)&quot;)],
) -&gt; HotelSuggestions:
    check_in_date = validate_iso_date(check_in, &quot;check_in&quot;)
    check_out_date = validate_iso_date(check_out, &quot;check_out&quot;)
    if check_out_date &lt;= check_in_date:
        raise ValueError(&quot;check_out date must be after check_in date&quot;)
    hotels = [
        Hotel(
            name=f&quot;Hotel {i}&quot;,
            address=&quot;123 Main St&quot;,
            location=location,
            rating=random.uniform(3, 5),
            price_per_night=random.randint(100, 500),
            hotel_type=&quot;Luxury&quot;,
            amenities=[&quot;WiFi&quot;, &quot;Pool&quot;],
            available_rooms=random.randint(1, 10),
        )
        for i in range(3)
    ]
    return HotelSuggestions(hotels=hotels)
</code></pre>
<ul>
<li>Validates check-in and check-out dates to prevent logical errors.</li>
<li>Dynamically generates mock hotel data with randomized attributes.</li>
<li>Uses Python&#39;s <code class="inline-code">dataclass</code> for structured, type-safe responses.</li>
<li>Demonstrates the use of MCP annotations to define tool inputs and outputs.</li>
<li>Highlights error handling to ensure robust tool behavior.</li>
</ul>
<hr>
<pre><code class="language-python">@mcp.tool()
async def suggest_flights(
    from_location: Annotated[str, Field(description=&quot;Departure location&quot;)],
    to_location: Annotated[str, Field(description=&quot;Destination location&quot;)],
    departure_date: Annotated[str, Field(description=&quot;Departure date in ISO format (YYYY-MM-DD)&quot;)],
    return_date: Annotated[str, Field(description=&quot;Return date in ISO format (YYYY-MM-DD)&quot;)],
) -&gt; FlightSuggestions:
    dep_date = validate_iso_date(departure_date, &quot;departure_date&quot;)
    ret_date = validate_iso_date(return_date, &quot;return_date&quot;)
    if ret_date &lt;= dep_date:
        raise ValueError(&quot;return_date must be after departure_date&quot;)
    flights = [
        Flight(
            flight_id=str(uuid.uuid4()),
            airline=&quot;SkyWings&quot;,
            flight_number=&quot;SW123&quot;,
            from_airport=Airport(code=&quot;JFK&quot;, name=&quot;JFK Airport&quot;, city=&quot;New York&quot;),
            to_airport=Airport(code=&quot;LAX&quot;, name=&quot;LAX Airport&quot;, city=&quot;Los Angeles&quot;),
            departure=dep_date.isoformat(),
            arrival=(dep_date + timedelta(hours=6)).isoformat(),
            duration_minutes=360,
            price=300.0,
            currency=&quot;USD&quot;,
            available_seats=10,
            cabin_class=&quot;Economy&quot;,
            is_direct=True,
        )
    ]
    return FlightSuggestions(departure_flights=flights, return_flights=flights)
</code></pre>
<ul>
<li>Ensures valid ISO date inputs and logical departure/return date sequences.</li>
<li>Generates mock flight data, including airlines, airports, and schedules.</li>
<li>Demonstrates the use of nested data classes for complex responses.</li>
<li>Highlights the ability to handle both direct and connecting flights.</li>
<li>Uses MCP annotations to define tool parameters and expected outputs.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</code></a></h3>
<p>This Java-based service provides destination recommendations based on user preferences. It uses Spring Boot and MCP annotations to expose tools for querying destinations by activity, budget, or season.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getDestinationsByActivity</code>: Recommends destinations based on activity type.</li>
<li><code class="inline-code">getDestinationsByBudget</code>: Filters destinations by budget category.</li>
<li><code class="inline-code">getDestinationsByPreferences</code>: Combines multiple criteria to suggest destinations.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on preferred activity type&quot;)
public String getDestinationsByActivity(String activityType) {
    if (!isValidActivityType(activityType.toUpperCase())) {
        return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION.&quot;;
    }
    return &quot;Recommended destinations for activity &quot; + activityType;
}
</code></pre>
<ul>
<li>Validates activity type to ensure input correctness.</li>
<li>Returns mock recommendations for simplicity.</li>
<li>Demonstrates the use of Spring Boot&#39;s <code class="inline-code">@Tool</code> annotation to expose functionality.</li>
<li>Highlights the modular design, enabling easy addition of new activity types.</li>
<li>Uses constants for predefined activity categories, ensuring consistency.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/echo-ping/src/server.ts</code></a></h3>
<p>The Echo MCP server, written in TypeScript, serves as a simple testing tool that echoes back received inputs. It demonstrates the MCP protocol&#39;s flexibility and the use of <code class="inline-code">StreamableHTTPServerTransport</code>.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupServerRequestHandlers</code>: Configures request handlers for listing and invoking tools.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L37" target="_blank" rel="noopener noreferrer"><code class="inline-code">handlePostRequest</code></a>: Handles incoming POST requests and manages transport connections.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L137" target="_blank" rel="noopener noreferrer"><code class="inline-code">createRPCErrorResponse</code></a>: Generates standardized error responses for JSON-RPC.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">setupServerRequestHandlers() {
  this.server.setRequestHandler(ListToolsRequestSchema, async () =&gt; ({
    tools: EchoTools,
  }));
  this.server.setRequestHandler(CallToolRequestSchema, async (request) =&gt; {
    const tool = EchoTools.find((t) =&gt; t.name === request.params.name);
    if (!tool) {
      return this.createRPCErrorResponse(`Tool ${request.params.name} not found.`);
    }
    return { result: tool.execute(request.params.arguments) };
  });
}
</code></pre>
<ul>
<li>Registers handlers for tool discovery and invocation, enabling dynamic interaction.</li>
<li>Uses JSON-RPC schemas to validate incoming requests.</li>
<li>Demonstrates a simple tool execution workflow.</li>
<li>Highlights the extensibility of the server for adding new tools.</li>
<li>Ensures robust error handling for unknown tools.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Study how <code class="inline-code">FastMCP</code> in Python simplifies MCP server creation and tool exposure.</li>
<li>Observe the use of Spring Boot annotations in Java to define MCP tools declaratively.</li>
<li>Explore how the Echo MCP server in TypeScript handles JSON-RPC requests dynamically.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><strong>Add a New Tool</strong>: Implement a new MCP tool in Python to suggest restaurants based on cuisine type. Register it in the <code class="inline-code">itinerary-planning</code> server and test its integration.</li>
<li><strong>Trace Data Flow</strong>: Use logging statements to trace the flow of a request through the Echo MCP server. Observe how the request is processed and how the response is generated.</li>
<li><strong>Enhance Validation</strong>: Modify the <code class="inline-code">getDestinationsByPreferences</code> method in the Java service to include validation for family-friendly destinations. Test the updated method with various inputs.</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the Polyglot Realm.</p>
<p>By the luminous stars of the Celestial Lexicon, you have triumphed in the Polyglot Realm of Agents, weaving the tongues of wisdom into your heroic tapestry‚Äîonward, valiant seeker, the next quest awaits! ‚ö°üíé‚≠ê</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>