<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Polyglot Guild of Magic - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-mythical">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/Azure-Samples/azure-ai-travel-agents" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">The Enchanted Realm of the Orchestrated Agents</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: The Polyglot Guild of Magic</h1>
<hr>
<p>In the mystical Kingdom of Azure, the Polyglot Guild of Magic thrives as a council of enchanting wizards, each mastering a unique magical dialect. The Triage Mage, wielding the ancient artifact LlamaIndex, orchestrates their efforts, ensuring that spells from Python, Java, and TypeScript converge seamlessly. The Guild‚Äôs enchanted tools, connected through the Model Context Protocol (MCP), empower travelers with itineraries, destination wisdom, and live insights from the Web of Fates. This quest explores the guild‚Äôs polyglot architecture, where diverse magical languages unite to create spellbinding results.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Tool Invocation Rituals</strong>: How do the MCP servers handle tool invocation requests across different languages?</li>
<li>‚ö° <strong>Multi-Language Spellbinding</strong>: How does the system ensure consistent behavior across Python, Java, and TypeScript implementations of MCP servers?</li>
<li>üõ°Ô∏è <strong>Error Safeguards</strong>: What validation and error-handling mechanisms protect the guild‚Äôs tools from invocation mishaps?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix"><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer">src/tools/itinerary-planning/src/mcp_server.py</a>:</span> Python Spell of Itinerary Planning</h3>
<p>This file contains the Python implementation of the MCP server for itinerary planning. Using the <code class="inline-code">FastMCP</code> framework, it generates mock hotel and flight suggestions based on user input. The server validates inputs, handles errors gracefully, and creates dynamic responses with realistic details. Its tools are decorated with <code class="inline-code">@mcp.tool()</code> annotations, enabling seamless integration with the MCP protocol.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">suggest_hotels(...)</code>: Generates detailed hotel suggestions based on location and dates, validating ISO date formats and ensuring check-out dates are after check-in dates.</li>
<li><code class="inline-code">suggest_flights(...)</code>: Creates mock flight data, including direct and connecting flights, validating departure and return dates.</li>
<li><code class="inline-code">validate_iso_date(...)</code>: Validates date formats and ensures proper error messaging for invalid inputs.</li>
</ul>
<h3><span class="header-prefix"><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</a>:</span> Java Spell of Destination Wisdom</h3>
<p>This file implements a Java MCP server that provides travel destination recommendations based on activity types, budget categories, and seasons. It uses Spring Boot annotations to define tools and validate inputs, ensuring the guild‚Äôs wisdom is accessible to travelers.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getDestinationsByActivity(String activityType)</code>: Recommends destinations based on activity type, validating inputs and providing fallback messages for invalid entries.</li>
<li><code class="inline-code">getDestinationsByPreferences(...)</code>: Offers multi-criteria destination recommendations, combining activity, budget, season, and family-friendly preferences.</li>
<li><code class="inline-code">getAllDestinations()</code>: Provides a curated list of popular destinations with hardcoded details for quick reference.</li>
</ul>
<h3><span class="header-prefix"><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer">src/tools/echo-ping/src/server.ts</a>:</span> TypeScript Spell of Echoing</h3>
<p>This file contains the TypeScript implementation of an MCP server that echoes input messages. It demonstrates tool registration and invocation handling using <code class="inline-code">StreamableHTTPServerTransport</code>. The server validates tool names and handles errors gracefully, showcasing the simplicity of MCP integration in TypeScript.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupServerRequestHandlers()</code>: Registers tools and defines request handlers for listing tools and invoking them.</li>
<li><code class="inline-code">handlePostRequest(req, res)</code>: Processes MCP requests, connecting the transport layer and sending notifications for established connections.</li>
<li><code class="inline-code">createRPCErrorResponse(message)</code>: Generates structured error responses for invalid tool invocations.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer">src/tools/itinerary-planning/src/mcp_server.py</a></h3>
<pre><code class="language-python">@mcp.tool()
async def suggest_hotels(
    location: Annotated[str, Field(description=&quot;Location (city or area) to search for hotels&quot;)],
    check_in: Annotated[str, Field(description=&quot;Check-in date in ISO format (YYYY-MM-DD)&quot;)],
    check_out: Annotated[str, Field(description=&quot;Check-out date in ISO format (YYYY-MM-DD)&quot;)],
) -&gt; HotelSuggestions:
    check_in_date = validate_iso_date(check_in, &quot;check_in&quot;)
    check_out_date = validate_iso_date(check_out, &quot;check_out&quot;)
    if check_out_date &lt;= check_in_date:
        raise ValueError(&quot;check_out date must be after check_in date&quot;)
    hotels = [
        Hotel(
            name=f&quot;{random.choice([&#39;Luxury&#39;, &#39;Boutique&#39;, &#39;Budget&#39;])} Hotel&quot;,
            address=fake.street_address(),
            location=f&quot;{location}&quot;,
            rating=random.uniform(3.0, 5.0),
            price_per_night=random.randint(80, 300),
            hotel_type=&quot;Luxury&quot;,
            amenities=[&quot;Pool&quot;, &quot;Free WiFi&quot;],
            available_rooms=random.randint(1, 10),
        )
    ]
    return HotelSuggestions(hotels=hotels)
</code></pre>
<ul>
<li>Validates ISO date formats to ensure proper input handling.</li>
<li>Generates mock hotel data with realistic details like amenities and ratings.</li>
<li>Demonstrates error handling for invalid check-out dates.</li>
</ul>
<hr>
<h3><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</a></h3>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on preferred activity type&quot;)
public String getDestinationsByActivity(String activityType) {
    String activity = activityType.toUpperCase();
    if (!isValidActivityType(activity)) {
        return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;
    }
    return getDestinationsByPreference(activity, null, null, null);
}
</code></pre>
<ul>
<li>Validates activity types to prevent invalid tool invocations.</li>
<li>Provides fallback messages for unsupported input values.</li>
<li>Demonstrates modular design by delegating preference handling to helper methods.</li>
</ul>
<hr>
<h3><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer">src/tools/echo-ping/src/server.ts</a></h3>
<pre><code class="language-typescript">private setupServerRequestHandlers() {
  this.server.setRequestHandler(ListToolsRequestSchema, async (_request) =&gt; {
    return { tools: EchoTools };
  });
  this.server.setRequestHandler(CallToolRequestSchema, async (request) =&gt; {
    const tool = EchoTools.find((t) =&gt; t.name === request.params.name);
    if (!tool) {
      return this.createRPCErrorResponse(`Tool ${request.params.name} not found.`);
    }
    const result = await tool.execute(request.params.arguments);
    return { content: [{ type: &#39;text&#39;, text: result }] };
  });
}
</code></pre>
<ul>
<li>Registers MCP tools and defines handlers for tool listing and invocation.</li>
<li>Validates tool names to prevent invalid calls.</li>
<li>Demonstrates extensibility by decoupling tool registration from execution logic.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Pay attention to how <code class="inline-code">@mcp.tool()</code> annotations in Python simplify tool registration compared to Java‚Äôs Spring Boot annotations.</li>
<li>Notice the consistent validation patterns across languages to ensure input integrity.</li>
<li>Explore how TypeScript‚Äôs <code class="inline-code">StreamableHTTPServerTransport</code> enhances real-time communication for MCP requests.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the enchanted guild‚Äôs multi-agent systems.</p>
<p>By the radiant stars of the Elder Constellation, brave scholars of The Polyglot Guild of Magic, you have unlocked the third arcane seal of linguistic mastery‚Äîforge ahead, for the final realms of enlightenment await your triumphant ascent! ‚ö°üíéüì°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>