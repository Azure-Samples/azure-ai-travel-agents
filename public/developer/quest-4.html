<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polyglot MCP Services Architecture - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/Azure-Samples/azure-ai-travel-agents" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Multi-Agent Orchestration with Azure AI Travel Agents</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: Polyglot MCP Services Architecture</h1>
<hr>
<p>Dive into the heart of the Azure AI Travel Agents system, where multiple MCP services, written in diverse programming languages, collaborate to power the multi-agent ecosystem. This quest explores the polyglot architecture, showcasing how Python, Java, and TypeScript implementations adhere to the Model Context Protocol. By integrating these components, the system achieves modularity and interoperability, enabling seamless communication between services and agents.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Tool Implementation</strong>: How MCP tools are implemented in Python, Java, and TypeScript to provide specific functionalities.</li>
<li>üîç <strong>Service Registration</strong>: How services register tools and expose capabilities using the MCP protocol.</li>
<li>‚ö° <strong>Language Interoperability</strong>: How the system maintains interoperability across different programming languages.</li>
<li>üí° <strong>Dynamic Tool Discovery</strong>: How tools are dynamically discovered and utilized in real-time workflows.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/itinerary-planning/src/mcp_server.py</code></a></h3>
<p>This Python-based MCP server provides itinerary planning capabilities, including hotel and flight suggestions. It uses the FastMCP library to define tools and handle requests, showcasing how Python&#39;s asynchronous capabilities enhance scalability.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">suggest_hotels</code>: Recommends hotels based on location and dates, validating input and generating mock data.</li>
<li><code class="inline-code">suggest_flights</code>: Suggests flights based on departure and return locations/dates, simulating direct and connecting flights.</li>
<li><code class="inline-code">validate_iso_date</code>: Ensures date parameters are in ISO format and valid, preventing input errors.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-python">@mcp.tool()
async def suggest_hotels(
    location: Annotated[str, Field(description=&quot;Location (city or area) to search for hotels&quot;)],
    check_in: Annotated[str, Field(description=&quot;Check-in date in ISO format (YYYY-MM-DD)&quot;)],
    check_out: Annotated[str, Field(description=&quot;Check-out date in ISO format (YYYY-MM-DD)&quot;)],
) -&gt; HotelSuggestions:
    check_in_date = validate_iso_date(check_in, &quot;check_in&quot;)
    check_out_date = validate_iso_date(check_out, &quot;check_out&quot;)
    if check_out_date &lt;= check_in_date:
        raise ValueError(&quot;check_out date must be after check_in date&quot;)

    # Generate mock hotel data
    hotels = [
        Hotel(
            name=&quot;Luxury Inn&quot;,
            address=&quot;123 Main St&quot;,
            location=f&quot;{location}&quot;,
            rating=4.5,
            price_per_night=300,
            hotel_type=&quot;Luxury&quot;,
            amenities=[&quot;Free WiFi&quot;, &quot;Pool&quot;],
            available_rooms=5,
        )
    ]
    return HotelSuggestions(hotels=hotels)
</code></pre>
<ul>
<li>Validates input dates using <code class="inline-code">validate_iso_date</code> to ensure correctness.</li>
<li>Demonstrates how mock data can simulate real-world hotel recommendations.</li>
<li>Uses Python&#39;s <code class="inline-code">dataclass</code> to define structured outputs, ensuring type safety.</li>
<li>Implements error handling to provide meaningful feedback on invalid inputs.</li>
<li>Highlights Python&#39;s asynchronous capabilities for handling concurrent requests.</li>
</ul>
<hr>
<pre><code class="language-python">@mcp.tool()
async def suggest_flights(
    from_location: Annotated[str, Field(description=&quot;Departure location (city or airport)&quot;)],
    to_location: Annotated[str, Field(description=&quot;Destination location (city or airport)&quot;)],
    departure_date: Annotated[str, Field(description=&quot;Departure date in ISO format (YYYY-MM-DD)&quot;)],
    return_date: Annotated[str, Field(description=&quot;Return date in ISO format (YYYY-MM-DD)&quot;)],
) -&gt; FlightSuggestions:
    dep_date = validate_iso_date(departure_date, &quot;departure_date&quot;)
    ret_date = validate_iso_date(return_date, &quot;return_date&quot;)
    if ret_date &lt;= dep_date:
        raise ValueError(&quot;return_date must be after departure_date&quot;)

    # Generate mock flight data
    departure_flights = [
        Flight(
            flight_id=&quot;FL123&quot;,
            airline=&quot;SkyWings&quot;,
            flight_number=&quot;SW123&quot;,
            aircraft=&quot;Boeing 737&quot;,
            from_airport=Airport(code=&quot;JFK&quot;, name=&quot;JFK Intl&quot;, city=&quot;New York&quot;),
            to_airport=Airport(code=&quot;LAX&quot;, name=&quot;LAX Intl&quot;, city=&quot;Los Angeles&quot;),
            departure=dep_date.isoformat(),
            arrival=(dep_date + timedelta(hours=5)).isoformat(),
            duration_minutes=300,
            is_direct=True,
            price=200.0,
            currency=&quot;USD&quot;,
            available_seats=100,
            cabin_class=&quot;Economy&quot;,
            segments=[],
            connection=None,
        )
    ]
    return FlightSuggestions(departure_flights=departure_flights, return_flights=[])
</code></pre>
<ul>
<li>Simulates flight data, including airline details, departure/arrival times, and pricing.</li>
<li>Validates ISO date formats and ensures logical date relationships.</li>
<li>Demonstrates how to structure complex objects like <code class="inline-code">Flight</code> and <code class="inline-code">Airport</code> using <code class="inline-code">dataclass</code>.</li>
<li>Implements both direct and connecting flight scenarios to mimic real-world complexity.</li>
<li>Highlights Python&#39;s flexibility in generating dynamic, mock data.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java</code></a></h3>
<p>This Java application uses Spring Boot to expose destination recommendation tools. It demonstrates how Java&#39;s strong typing and annotations simplify MCP tool registration and lifecycle management.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">main</code>: Bootstraps the Spring Boot application, initializing the MCP server.</li>
<li><code class="inline-code">destinationTools</code>: Registers <code class="inline-code">DestinationService</code> tools using the <code class="inline-code">ToolCallbackProvider</code> bean.</li>
<li><code class="inline-code">@SpringBootApplication</code>: Simplifies configuration and setup for the MCP server.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-java">@SpringBootApplication
public class McpServerApplication {

    private static final Logger logger = LoggerFactory.getLogger(McpServerApplication.class);

    public static void main(String[] args) {
        SpringApplication.run(McpServerApplication.class, args);
    }
    
    @Bean
    public ToolCallbackProvider destinationTools(DestinationService destinationService) {
        return MethodToolCallbackProvider.builder().toolObjects(destinationService).build();
    }
}
</code></pre>
<ul>
<li>Uses <code class="inline-code">@SpringBootApplication</code> to encapsulate configuration and bootstrap logic.</li>
<li>Registers tools dynamically via <code class="inline-code">MethodToolCallbackProvider</code>, simplifying extensibility.</li>
<li>Demonstrates dependency injection with <code class="inline-code">DestinationService</code> for seamless integration.</li>
<li>Leverages Spring Boot&#39;s lifecycle management for robust server operation.</li>
<li>Highlights Java&#39;s strong typing and annotation-based configuration.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/echo-ping/src/server.ts</code></a></h3>
<p>This TypeScript-based MCP server provides a simple echo tool, showcasing how TypeScript&#39;s type safety and modularity enable efficient tool implementation.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupServerRequestHandlers</code>: Configures tool handlers for listing and executing tools.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L37" target="_blank" rel="noopener noreferrer"><code class="inline-code">handlePostRequest</code></a>: Handles incoming requests and routes them to the appropriate tool.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L137" target="_blank" rel="noopener noreferrer"><code class="inline-code">createRPCErrorResponse</code></a>: Generates standardized error responses for MCP requests.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">private setupServerRequestHandlers() {
    this.server.setRequestHandler(ListToolsRequestSchema, async (_request) =&gt; {
      return {
        jsonrpc: JSON_RPC,
        tools: EchoTools,
      };
    });
    this.server.setRequestHandler(
      CallToolRequestSchema,
      async (request, _extra) =&gt; {
        const toolName = request.params.name;
        const tool = EchoTools.find((tool) =&gt; tool.name === toolName);

        if (!tool) {
          return this.createRPCErrorResponse(`Tool ${toolName} not found.`);
        }
        const result = await tool.execute(request.params.arguments);
        return {
          jsonrpc: JSON_RPC,
          content: [{ type: &#39;text&#39;, text: `Executed tool: ${toolName}` }],
        };
      }
    );
}
</code></pre>
<ul>
<li>Implements handlers for listing and executing tools, ensuring dynamic tool discovery.</li>
<li>Validates tool existence and executes the appropriate handler dynamically.</li>
<li>Demonstrates error handling with <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L137" target="_blank" rel="noopener noreferrer"><code class="inline-code">createRPCErrorResponse</code></a> for robustness.</li>
<li>Highlights TypeScript&#39;s type safety and modular design.</li>
<li>Enables extensibility by decoupling tool registration from execution logic.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Compare how Python, Java, and TypeScript handle MCP tool registration to identify common patterns.</li>
<li>Study the error handling in each implementation to understand how robustness is achieved across languages.</li>
<li>Observe how mock data is generated in Python and Java to simulate real-world scenarios.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><strong>Add a New Tool</strong>: Implement a new MCP tool in Python (e.g., <code class="inline-code">suggest_car_rentals</code>) and register it with the itinerary planning server. Use the existing hotel and flight tools as references.</li>
<li><strong>Trace Tool Calls</strong>: Add debug logs to the <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L37" target="_blank" rel="noopener noreferrer"><code class="inline-code">handlePostRequest</code></a> method in the TypeScript server to trace the lifecycle of a tool call, from request to response.</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of this multi-agent ecosystem.</p>
<p>Congratulations on successfully deploying the Polyglot MCP Services Architecture‚Äîyour multi-language microservices are now a robust, scalable constellation of interconnected endpoints; keep refactoring forward, you&#39;re 60% to full-stack mastery! üöÄ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>