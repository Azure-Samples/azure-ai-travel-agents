<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polyglot MCP Services - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/Azure-Samples/azure-ai-travel-agents" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Azure AI Travel Agents: Multi-Agent Orchestration Guide</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: Polyglot MCP Services Architecture</h1>
<hr>
<p>Dive into the heart of the Azure AI Travel Agents system, where the polyglot architecture shines through MCP servers implemented in Python, Java, and TypeScript. These services demonstrate the power of language diversity in achieving specialized functionality while adhering to the Model Context Protocol for seamless integration.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Polyglot Microservices</strong>: How MCP servers leverage diverse languages to implement specialized tools.</li>
<li>üîç <strong>Tool Registration</strong>: How MCP servers expose tools and validate requests dynamically.</li>
<li>‚ö° <strong>Scalable Architecture</strong>: How the system maintains modularity and extensibility across different programming environments.</li>
<li>üí° <strong>Dynamic Tool Discovery</strong>: How tools are discovered and invoked using MCP protocol standards.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/itinerary-planning/src/mcp_server.py</code></a></h3>
<p>This Python-based MCP server specializes in itinerary planning, offering tools for hotel and flight suggestions. It showcases robust input validation, dynamic mock data generation, and asynchronous tool execution using FastAPI and MCP SDK.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">suggest_hotels(location, check_in, check_out)</code> generates realistic hotel suggestions based on location and dates, with validation for ISO date formats.</li>
<li><code class="inline-code">suggest_flights(from_location, to_location, departure_date, return_date)</code> dynamically generates flight options, including direct and connecting flights.</li>
<li><code class="inline-code">validate_iso_date(date_str, param_name)</code> ensures date inputs are in ISO format, preventing invalid data from entering the system.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-python">@mcp.tool()
async def suggest_hotels(
    location: Annotated[str, Field(description=&quot;Location (city or area) to search for hotels&quot;)],
    check_in: Annotated[str, Field(description=&quot;Check-in date in ISO format (YYYY-MM-DD)&quot;)],
    check_out: Annotated[str, Field(description=&quot;Check-out date in ISO format (YYYY-MM-DD)&quot;)],
) -&gt; HotelSuggestions:
    check_in_date = validate_iso_date(check_in, &quot;check_in&quot;)
    check_out_date = validate_iso_date(check_out, &quot;check_out&quot;)
    if check_out_date &lt;= check_in_date:
        raise ValueError(&quot;check_out date must be after check_in date&quot;)
    hotels = [
        Hotel(
            name=f&quot;{random.choice([&#39;Luxury&#39;, &#39;Boutique&#39;, &#39;Budget&#39;])} Hotel&quot;,
            address=fake.street_address(),
            location=location,
            rating=round(random.uniform(3.0, 5.0), 1),
            price_per_night=random.randint(100, 500),
            hotel_type=&quot;Luxury&quot;,
            amenities=[&quot;Free WiFi&quot;, &quot;Pool&quot;, &quot;Spa&quot;],
            available_rooms=random.randint(1, 10),
        )
        for _ in range(5)
    ]
    return HotelSuggestions(hotels=hotels)
</code></pre>
<ul>
<li>Validates check-in and check-out dates to ensure logical input.</li>
<li>Dynamically generates hotel data with realistic attributes such as price and amenities.</li>
<li>Utilizes Python&#39;s <code class="inline-code">dataclass</code> for structured responses, ensuring compatibility with MCP standards.</li>
</ul>
<hr>
<pre><code class="language-python">@mcp.tool()
async def suggest_flights(
    from_location: Annotated[str, Field(description=&quot;Departure location (city or airport)&quot;)],
    to_location: Annotated[str, Field(description=&quot;Destination location (city or airport)&quot;)],
    departure_date: Annotated[str, Field(description=&quot;Departure date in ISO format (YYYY-MM-DD)&quot;)],
    return_date: Annotated[str, Field(description=&quot;Return date in ISO format (YYYY-MM-DD)&quot;)],
) -&gt; FlightSuggestions:
    dep_date = validate_iso_date(departure_date, &quot;departure_date&quot;)
    ret_date = validate_iso_date(return_date, &quot;return_date&quot;)
    if ret_date &lt;= dep_date:
        raise ValueError(&quot;return_date must be after departure_date&quot;)
    departure_flights = [
        Flight(
            flight_id=str(uuid.uuid4()),
            airline=&quot;SkyWings&quot;,
            flight_number=f&quot;{random.randint(100, 999)}&quot;,
            aircraft=&quot;Boeing 737&quot;,
            from_airport=Airport(code=&quot;JFK&quot;, name=&quot;John F. Kennedy Airport&quot;, city=&quot;New York&quot;),
            to_airport=Airport(code=&quot;LAX&quot;, name=&quot;Los Angeles Airport&quot;, city=&quot;Los Angeles&quot;),
            departure=dep_date.isoformat(),
            arrival=(dep_date + timedelta(hours=5)).isoformat(),
            duration_minutes=300,
            is_direct=True,
            price=random.uniform(100, 500),
            currency=&quot;USD&quot;,
            available_seats=random.randint(1, 100),
            cabin_class=&quot;Economy&quot;,
            segments=[],
            connection=None,
        )
        for _ in range(5)
    ]
    return FlightSuggestions(departure_flights=departure_flights, return_flights=[])
</code></pre>
<ul>
<li>Validates flight dates and ensures logical sequencing between departure and return dates.</li>
<li>Generates realistic flight data, including direct and connecting options.</li>
<li>Demonstrates modular data generation using helper methods for airports, segments, and flight attributes.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</code></a></h3>
<p>This Java-based MCP server focuses on destination recommendations based on user preferences. It demonstrates the use of Spring Boot annotations and structured tool methods to expose functionality.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getDestinationsByActivity(activityType)</code> recommends destinations based on activity preferences, validating inputs against predefined constants.</li>
<li><code class="inline-code">getDestinationsByBudget(budget)</code> filters destinations by budget categories, ensuring only valid inputs are processed.</li>
<li><code class="inline-code">getDestinationsByPreferences(activity, budget, season, familyFriendly)</code> combines multiple criteria to generate tailored recommendations.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on preferred activity type&quot;)
public String getDestinationsByActivity(String activityType) {
    String activity = activityType.toUpperCase();
    if (!isValidActivityType(activity)) {
        return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;
    }
    return getDestinationsByPreference(activity, null, null, null);
}
</code></pre>
<ul>
<li>Validates user input against predefined constants for activity types.</li>
<li>Ensures error messages are clear and informative for invalid inputs.</li>
<li>Demonstrates encapsulation by delegating preference-based logic to a helper method.</li>
</ul>
<hr>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on budget category&quot;)
public String getDestinationsByBudget(String budget) {
    String budgetCategory = budget.toUpperCase();
    if (!isValidBudgetCategory(budgetCategory)) {
        return &quot;Invalid budget category. Please use one of: BUDGET, MODERATE, LUXURY&quot;;
    }
    return getDestinationsByPreference(null, budgetCategory, null, null);
}
</code></pre>
<ul>
<li>Filters destinations by budget categories using structured validation.</li>
<li>Highlights modular design by separating validation logic from recommendation generation.</li>
<li>Facilitates extensibility for additional budget categories if needed.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/echo-ping/src/server.ts</code></a></h3>
<p>This TypeScript-based MCP server provides a simple echo tool, showcasing the core MCP server setup and tool registration process.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupServerRequestHandlers()</code> registers available tools and handles tool invocation requests.</li>
<li><code class="inline-code">handlePostRequest(req, res)</code> processes incoming HTTP POST requests and routes them to MCP tools.</li>
<li><code class="inline-code">createRPCErrorResponse(message)</code> generates standardized error responses for invalid requests.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">private setupServerRequestHandlers() {
    this.server.setRequestHandler(ListToolsRequestSchema, async (_request) =&gt; {
        return {
            jsonrpc: JSON_RPC,
            tools: EchoTools,
        };
    });
    this.server.setRequestHandler(CallToolRequestSchema, async (request, _extra) =&gt; {
        const args = request.params.arguments;
        const toolName = request.params.name;
        const tool = EchoTools.find((tool) =&gt; tool.name === toolName);
        if (!tool) {
            return this.createRPCErrorResponse(`Tool ${toolName} not found.`);
        }
        const result = await tool.execute(args as any);
        return {
            jsonrpc: JSON_RPC,
            content: [{ type: &#39;text&#39;, text: `Result: ${JSON.stringify(result)}` }],
        };
    });
}
</code></pre>
<ul>
<li>Dynamically registers tools and validates tool invocation requests.</li>
<li>Demonstrates error handling with standardized JSON-RPC error responses.</li>
<li>Highlights extensibility for adding new tools without modifying core logic.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Observe how each language leverages its strengths to implement MCP servers (e.g., Python for dynamic mock data, Java for structured validation, TypeScript for server setup).</li>
<li>Study the error handling patterns in each server to ensure robust input validation and user-friendly feedback.</li>
<li>Explore the modular design of tool registration and invocation logic to understand how new tools can be integrated seamlessly.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><strong>Add a New Tool</strong>: Create a new MCP server in Python or TypeScript that calculates currency conversion rates. Implement tool registration and expose it via MCP protocol.</li>
<li><strong>Trace Tool Invocation</strong>: Add logging statements to observe how requests flow through the MCP server, from tool discovery to execution.</li>
<li><strong>Refactor Validation Logic</strong>: Consolidate validation methods (e.g., <code class="inline-code">isValidActivityType</code>) into reusable utility classes or modules for cleaner code organization.</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the Azure AI Travel Agents system.</p>
<p>Achievement unlocked: Polyglot MCP Services successfully deployed‚Äîyour coding stack is scaling like a high-performance microservice; keep pushing towards 100%! üöÄ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>