<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polyglot MCP Services - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }
        
        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-developer">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/Azure-Samples/azure-ai-travel-agents" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Multi-Agent Orchestration with Azure AI Travel Agents</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: Polyglot MCP Services Architecture</h1>
<hr>
<p>Dive into the polyglot architecture of the Azure AI Travel Agents project, where MCP services demonstrate the power of multi-language interoperability. This quest explores how specialized services, implemented in Python, Java, and TypeScript, integrate seamlessly through the Model Context Protocol (MCP). By examining code from key MCP servers, you&#39;ll uncover patterns for tool discovery, dynamic request handling, and modular service design.</p>
<h2>Quest Objectives</h2>
<p>As you explore the code below, investigate these key questions:</p>
<ul>
<li>üîç <strong>Tool Discovery Mechanisms</strong>: How do MCP servers expose their tools and capabilities for dynamic discovery by clients?</li>
<li>‚ö° <strong>Service Initialization</strong>: What patterns ensure that each MCP service initializes dependencies and handlers effectively?</li>
<li>üõ°Ô∏è <strong>Error Handling in Requests</strong>: How do these services validate inputs and manage errors to ensure robust operations?</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix"><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</a>:</span> Java-based Destination Recommendation Service</h3>
<p>The <code class="inline-code">DestinationService</code> class provides travel recommendations based on user preferences such as activity type, budget, and season. It demonstrates the use of Spring Boot and MCP annotations to define tools and manage service logic. This file is central to the Java-based MCP service.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getDestinationsByActivity</code>: Filters destinations based on the user&#39;s preferred activity type.</li>
<li><code class="inline-code">getDestinationsByPreferences</code>: Combines multiple criteria (activity, budget, season, family-friendly) for tailored recommendations.</li>
<li><code class="inline-code">getAllDestinations</code>: Provides a static list of popular destinations for general queries.</li>
<li><code class="inline-code">@Tool</code> annotations: Define MCP tools with descriptions for dynamic discovery.</li>
<li><code class="inline-code">isValidActivityType</code>: Validates activity types to prevent invalid requests.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</a></h3>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on preferred activity type&quot;)
public String getDestinationsByActivity(String activityType) {
    try {
        String activity = activityType.toUpperCase();
        if (!isValidActivityType(activity)) {
            return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;
        }
        return getDestinationsByPreference(activity, null, null, null);
    } catch (Exception e) {
        return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;
    }
}
</code></pre>
<ul>
<li>This method uses <code class="inline-code">@Tool</code> to expose itself as an MCP tool for dynamic discovery.</li>
<li>Validates the <code class="inline-code">activityType</code> parameter to ensure compliance with predefined categories.</li>
<li>Demonstrates exception handling to provide user-friendly error messages.</li>
<li>Uses a helper function to delegate the actual recommendation logic.</li>
</ul>
<hr>
<h3><span class="header-prefix"><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java" target="_blank" rel="noopener noreferrer">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java</a>:</span> Java Spring Boot Application Entry Point</h3>
<p>This file initializes the MCP server for the destination recommendation service. It uses Spring Boot&#39;s dependency injection to configure the service and its tools.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">main</code>: Launches the Spring Boot application.</li>
<li><code class="inline-code">destinationTools</code>: Registers <code class="inline-code">DestinationService</code> tools via the <code class="inline-code">ToolCallbackProvider</code> bean.</li>
<li><code class="inline-code">@SpringBootApplication</code>: Marks the entry point for the Spring Boot application.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java" target="_blank" rel="noopener noreferrer">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/McpServerApplication.java</a></h3>
<pre><code class="language-java">@Bean
public ToolCallbackProvider destinationTools(DestinationService destinationService) {
    return MethodToolCallbackProvider.builder().toolObjects(destinationService).build();
}
</code></pre>
<ul>
<li>Registers all tools in <code class="inline-code">DestinationService</code> for MCP discovery and execution.</li>
<li>Uses dependency injection to ensure the service is correctly initialized.</li>
<li>Demonstrates how Spring Boot integrates with MCP&#39;s <code class="inline-code">ToolCallbackProvider</code>.</li>
</ul>
<hr>
<h3><span class="header-prefix"><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer">src/tools/echo-ping/src/server.ts</a>:</span> TypeScript Echo MCP Service</h3>
<p>The <code class="inline-code">EchoMCPServer</code> class is a simple MCP server that demonstrates tool registration and request handling in TypeScript. It serves as a reference implementation for MCP services.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupServerRequestHandlers</code>: Registers tool handlers for listing and invoking tools.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L37" target="_blank" rel="noopener noreferrer"><code class="inline-code">handlePostRequest</code></a>: Processes incoming MCP requests via the HTTP transport layer.</li>
<li><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts#L137" target="_blank" rel="noopener noreferrer"><code class="inline-code">createRPCErrorResponse</code></a>: Generates standardized error responses for invalid requests.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer">src/tools/echo-ping/src/server.ts</a></h3>
<pre><code class="language-typescript">private setupServerRequestHandlers() {
    this.server.setRequestHandler(ListToolsRequestSchema, async (_request) =&gt; {
        return {
            jsonrpc: JSON_RPC,
            tools: EchoTools,
        };
    });
    this.server.setRequestHandler(
        CallToolRequestSchema,
        async (request, _extra) =&gt; {
            const toolName = request.params.name;
            const tool = EchoTools.find((tool) =&gt; tool.name === toolName);

            if (!tool) {
                return this.createRPCErrorResponse(`Tool ${toolName} not found.`);
            }
            try {
                const result = await tool.execute(request.params.arguments || {});
                return {
                    jsonrpc: JSON_RPC,
                    content: [{ type: &#39;text&#39;, text: `Result: ${JSON.stringify(result)}` }],
                };
            } catch (error) {
                return this.createRPCErrorResponse(`Error executing tool: ${error}`);
            }
        }
    );
}
</code></pre>
<ul>
<li>Registers handlers for listing tools and executing specific tools dynamically.</li>
<li>Implements error handling to manage missing tools and execution errors gracefully.</li>
<li>Demonstrates separation of concerns by delegating tool execution to <code class="inline-code">EchoTools</code>.</li>
</ul>
<hr>
<h3><span class="header-prefix"><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer">src/tools/itinerary-planning/src/mcp_server.py</a>:</span> Python-based Itinerary Planning Service</h3>
<p>This Python MCP server generates travel itineraries, including hotel and flight suggestions. It uses FastAPI and MCP for a lightweight yet powerful implementation.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">suggest_hotels</code>: Generates hotel recommendations based on location and dates.</li>
<li><code class="inline-code">suggest_flights</code>: Provides flight options for specified locations and dates.</li>
<li><code class="inline-code">validate_iso_date</code>: Ensures date parameters are in the correct ISO format.</li>
<li><code class="inline-code">mcp.run</code>: Starts the MCP server with SSE transport for real-time communication.</li>
</ul>
<h2>Code</h2>
<h3><a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer">src/tools/itinerary-planning/src/mcp_server.py</a></h3>
<pre><code class="language-python">@mcp.tool()
async def suggest_hotels(location: Annotated[str, Field(description=&quot;Location to search for hotels&quot;)],
                         check_in: Annotated[str, Field(description=&quot;Check-in date in ISO format (YYYY-MM-DD)&quot;)],
                         check_out: Annotated[str, Field(description=&quot;Check-out date in ISO format (YYYY-MM-DD)&quot;)]) -&gt; HotelSuggestions:
    check_in_date = validate_iso_date(check_in, &quot;check_in&quot;)
    check_out_date = validate_iso_date(check_out, &quot;check_out&quot;)
    if check_out_date &lt;= check_in_date:
        raise ValueError(&quot;check_out date must be after check_in date&quot;)
    # Generate hotel data...
    return HotelSuggestions(hotels=hotels)
</code></pre>
<ul>
<li>Uses <code class="inline-code">@mcp.tool()</code> to expose the function as an MCP tool.</li>
<li>Validates input parameters for correctness and logical consistency.</li>
<li>Implements error handling to provide meaningful feedback for invalid inputs.</li>
<li>Demonstrates structured data modeling with <code class="inline-code">HotelSuggestions</code>.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Study how <code class="inline-code">@Tool</code> and <code class="inline-code">@mcp.tool()</code> annotations expose methods for MCP discovery.</li>
<li>Observe how each service validates inputs to prevent runtime errors.</li>
<li>Explore the use of dependency injection and modular design in multi-language MCP servers.</li>
</ul>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the Azure AI Travel Agents project.</p>
<p>Congratulations on deploying Polyglot MCP Services with 60% of your mission stack completed‚Äîyour codebase is evolving into a high-performing, multilingual API powerhouse; keep iterating and watch your progress compile into brilliance! üöÄ‚ö°üíé</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>