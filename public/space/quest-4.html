<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polyglot Service Modules - Repo Adventure</title>
    <link rel="stylesheet" href="assets/theme.css">
    <link rel="stylesheet" href="../assets/shared/quest-navigator.css">
    <link rel="stylesheet" href="../assets/theme-toggle.css">
    <!-- Prism.js for syntax highlighting -->
    <!-- Using minimal theme since we override all styles with our custom theme -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Configure Prism autoloader for syntax highlighting
        if (window.Prism && window.Prism.plugins && window.Prism.plugins.autoloader) {
            window.Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
        }

        // Trigger Prism highlighting after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Prism) {
                window.Prism.highlightAll();
            }
        });
    </script>
</head>
<body class="theme-space">

    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <a href="https://github.com/Azure-Samples/azure-ai-travel-agents" target="_blank" rel="noopener noreferrer" class="github-link">
                    <img src="../assets/shared/github-mark-white.svg" alt="GitHub" width="24" height="24">
                </a>
                <a href="index.html">Galactic Mission: The Stellar Codex</a>
            </div>
            <div class="nav-middle">
            </div>
            <div class="nav-right">
                <a href="../index.html" class="nav-link">Change Theme</a>
                <a href="#" class="nav-link quest-map-trigger">Quests</a>
                <button class="theme-toggle-btn" aria-label="Switch to light mode" type="button">
                    <div class="theme-toggle-slider">
                        <svg class="toggle-icon sun-icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="4" fill="currentColor"/>
                            <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <svg class="toggle-icon moon-icon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="quest-content">
    <h1>Quest 4: Polyglot Service Modules</h1>
<hr>
<p>In the vast expanse of the galaxy, the <em>Azure Voyager</em> relies on its polyglot MCP service modules to navigate the intricate web of interstellar travel. Each service, coded in a distinct language, operates as a specialized beacon, illuminating the path for the Stellar Codex to orchestrate seamless multi-agent workflows. Your mission is to delve into these diverse modules, uncover their unique implementations, and ensure their harmonious integration within the ship&#39;s systems.</p>
<h2>Key Takeaways</h2>
<p>After completing this quest, you will understand:</p>
<ul>
<li>üéØ <strong>Polyglot MCP Architecture</strong>: How diverse languages (Python, Java, TypeScript) are unified under the MCP protocol for seamless interoperability.</li>
<li>üîç <strong>Tool Registration Patterns</strong>: How tools are dynamically registered and exposed via MCP service interfaces.</li>
<li>‚ö° <strong>Service-Specific Implementations</strong>: The nuances of implementing domain-specific logic in different languages while adhering to MCP standards.</li>
<li>üí° <strong>Dynamic Tool Discovery</strong>: How the MCP protocol enables real-time identification and utilization of available services.</li>
</ul>
<h2>File Exploration</h2>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/itinerary-planning/src/mcp_server.py" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/itinerary-planning/src/mcp_server.py</code></a></h3>
<p>The Python-based itinerary planning module serves as the ship&#39;s navigator, generating flight and hotel recommendations tailored to crew preferences. It leverages <code class="inline-code">FastMCP</code> for tool registration, ensuring seamless communication with other agents in the MCP ecosystem.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">suggest_hotels(location, check_in, check_out)</code>: Generates hotel suggestions based on location and dates, validating inputs and creating realistic mock data.</li>
<li><code class="inline-code">suggest_flights(from_location, to_location, departure_date, return_date)</code>: Provides flight recommendations, including direct and connecting options with detailed mock data.</li>
<li><code class="inline-code">validate_iso_date(date_str, param_name)</code>: Ensures date parameters conform to ISO format, preventing invalid inputs.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-python">@mcp.tool()
async def suggest_hotels(
    location: Annotated[str, Field(description=&quot;Location (city or area) to search for hotels&quot;)],
    check_in: Annotated[str, Field(description=&quot;Check-in date in ISO format (YYYY-MM-DD)&quot;)],
    check_out: Annotated[str, Field(description=&quot;Check-out date in ISO format (YYYY-MM-DD)&quot;)],
) -&gt; HotelSuggestions:
    check_in_date = validate_iso_date(check_in, &quot;check_in&quot;)
    check_out_date = validate_iso_date(check_out, &quot;check_out&quot;)
    if check_out_date &lt;= check_in_date:
        raise ValueError(&quot;check_out date must be after check_in date&quot;)

    hotel_types = [&quot;Luxury&quot;, &quot;Boutique&quot;, &quot;Budget&quot;, &quot;Business&quot;]
    amenities = [&quot;Free WiFi&quot;, &quot;Pool&quot;, &quot;Spa&quot;, &quot;Gym&quot;, &quot;Restaurant&quot;, &quot;Bar&quot;, &quot;Room Service&quot;, &quot;Parking&quot;]

    def generate_rating():
        return round(random.uniform(3.0, 5.0), 1)

    def generate_price(hotel_type):
        price_ranges = {
            &quot;Luxury&quot;: (250, 600),
            &quot;Boutique&quot;: (180, 350),
            &quot;Budget&quot;: (80, 150),
            &quot;Business&quot;: (150, 300),
        }
        min_price, max_price = price_ranges.get(hotel_type, (100, 300))
        return round(random.uniform(min_price, max_price))

    hotels = [
        Hotel(
            name=f&quot;{hotel_types[random.randint(0, 3)]} Hotel&quot;,
            address=fake.street_address(),
            location=f&quot;{location}, Downtown&quot;,
            rating=generate_rating(),
            price_per_night=generate_price(hotel_types[random.randint(0, 3)]),
            hotel_type=hotel_types[random.randint(0, 3)],
            amenities=random.sample(amenities, random.randint(3, 6)),
            available_rooms=random.randint(1, 15),
        )
        for _ in range(random.randint(3, 8))
    ]
    hotels.sort(key=lambda x: x.rating, reverse=True)
    return HotelSuggestions(hotels=hotels)
</code></pre>
<ul>
<li>Validates input dates to ensure logical check-in and check-out periods.</li>
<li>Uses mock data generation techniques to simulate realistic hotel suggestions.</li>
<li>Demonstrates extensibility by allowing dynamic hotel type and amenity configurations.</li>
</ul>
<hr>
<pre><code class="language-python">@mcp.tool()
async def suggest_flights(
    from_location: Annotated[str, Field(description=&quot;Departure location (city or airport)&quot;)],
    to_location: Annotated[str, Field(description=&quot;Destination location (city or airport)&quot;)],
    departure_date: Annotated[str, Field(description=&quot;Departure date in ISO format (YYYY-MM-DD)&quot;)],
    return_date: Annotated[str, Field(description=&quot;Return date in ISO format (YYYY-MM-DD)&quot;)],
) -&gt; FlightSuggestions:
    dep_date = validate_iso_date(departure_date, &quot;departure_date&quot;)
    ret_date = validate_iso_date(return_date, &quot;return_date&quot;)
    if ret_date &lt;= dep_date:
        return &quot;Error: return_date must be after departure_date&quot;

    airlines = [&quot;SkyWings&quot;, &quot;Global Air&quot;, &quot;Atlantic Airways&quot;]
    aircraft_types = [&quot;Boeing 737&quot;, &quot;Airbus A320&quot;]

    departure_flights = [
        Flight(
            flight_id=str(uuid.uuid4())[:8].upper(),
            airline=random.choice(airlines),
            flight_number=f&quot;{random.choice(&#39;ABCDEFG&#39;)}{random.randint(100, 9999)}&quot;,
            aircraft=random.choice(aircraft_types),
            from_airport=Airport(code=&quot;ATL&quot;, name=&quot;Atlanta Airport&quot;, city=&quot;Atlanta&quot;),
            to_airport=Airport(code=&quot;JFK&quot;, name=&quot;JFK Airport&quot;, city=&quot;New York&quot;),
            departure=dep_date.isoformat(),
            arrival=(dep_date + timedelta(hours=random.randint(2, 5))).isoformat(),
            duration_minutes=random.randint(120, 300),
            is_direct=True,
            price=round(random.uniform(99, 999), 2),
            currency=&quot;USD&quot;,
            available_seats=random.randint(1, 30),
            cabin_class=&quot;Economy&quot;,
            segments=[],
            connection=None,
        )
        for _ in range(random.randint(3, 7))
    ]
    return FlightSuggestions(departure_flights=departure_flights, return_flights=[])
</code></pre>
<ul>
<li>Generates mock flight data with randomized attributes for diversity.</li>
<li>Implements direct and connecting flight logic to simulate real-world scenarios.</li>
<li>Validates input dates to ensure logical departure and return schedules.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/destination-recommendation/src/main/java/com/microsoft/mcp/sample/server/service/DestinationService.java</code></a></h3>
<p>The Java-based destination recommendation module acts as a cultural guide, offering curated travel suggestions based on user preferences. It employs Spring Boot annotations for tool registration and integrates validation logic for robust input handling.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">getDestinationsByActivity(activityType)</code>: Recommends destinations based on preferred activity types such as BEACH or ADVENTURE.</li>
<li><code class="inline-code">getDestinationsByPreferences(activity, budget, season, familyFriendly)</code>: Combines multiple criteria to provide tailored destination suggestions.</li>
<li><code class="inline-code">echoMessage(message)</code>: Demonstrates basic echo functionality for debugging and validation purposes.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on preferred activity type&quot;)
public String getDestinationsByActivity(String activityType) {
    String activity = activityType.toUpperCase();
    if (!isValidActivityType(activity)) {
        return &quot;Invalid activity type. Please use one of: BEACH, ADVENTURE, CULTURAL, RELAXATION, URBAN_EXPLORATION, NATURE, WINTER_SPORTS&quot;;
    }
    return getDestinationsByPreference(activity, null, null, null);
}
</code></pre>
<ul>
<li>Validates activity types to prevent invalid queries.</li>
<li>Uses helper methods to centralize validation logic for reusability.</li>
<li>Demonstrates Spring Boot&#39;s annotation-based tool registration.</li>
</ul>
<hr>
<pre><code class="language-java">@Tool(description = &quot;Get travel destination recommendations based on multiple criteria&quot;)
public String getDestinationsByPreferences(String activity, String budget, String season, Boolean familyFriendly) {
    if (activity != null &amp;&amp; !isValidActivityType(activity.toUpperCase())) {
        return &quot;Invalid activity type.&quot;;
    }
    if (budget != null &amp;&amp; !isValidBudgetCategory(budget.toUpperCase())) {
        return &quot;Invalid budget category.&quot;;
    }
    if (season != null &amp;&amp; !isValidSeason(season.toUpperCase())) {
        return &quot;Invalid season.&quot;;
    }
    return getDestinationsByPreference(activity, budget, season, familyFriendly);
}
</code></pre>
<ul>
<li>Combines multiple criteria for tailored recommendations.</li>
<li>Centralizes validation logic to ensure consistent input handling.</li>
<li>Enables extensibility for additional preferences such as family-friendly options.</li>
</ul>
<hr>
<h3><span class="header-prefix">File:</span> <a href="https://github.com/Azure-Samples/azure-ai-travel-agents/blob/main/src/tools/echo-ping/src/server.ts" target="_blank" rel="noopener noreferrer"><code class="inline-code">src/tools/echo-ping/src/server.ts</code></a></h3>
<p>The TypeScript-based echo server module functions as a diagnostic tool, validating MCP protocol requests and responses. It showcases dynamic tool registration and error handling patterns.</p>
<h4>Highlights</h4>
<ul>
<li><code class="inline-code">setupServerRequestHandlers()</code>: Dynamically registers MCP tools for external discovery.</li>
<li><code class="inline-code">handlePostRequest(req, res)</code>: Processes incoming POST requests and connects transport layers.</li>
<li><code class="inline-code">createRPCErrorResponse(message)</code>: Constructs standardized error responses for invalid requests.</li>
</ul>
<h4>Code</h4>
<pre><code class="language-typescript">private setupServerRequestHandlers() {
    this.server.setRequestHandler(ListToolsRequestSchema, async (_request) =&gt; {
        return {
            jsonrpc: JSON_RPC,
            tools: EchoTools,
        };
    });
    this.server.setRequestHandler(CallToolRequestSchema, async (request, _extra) =&gt; {
        const toolName = request.params.name;
        const tool = EchoTools.find((tool) =&gt; tool.name === toolName);
        if (!tool) {
            return this.createRPCErrorResponse(`Tool ${toolName} not found.`);
        }
        const result = await tool.execute(request.params.arguments);
        return {
            jsonrpc: JSON_RPC,
            content: [{ type: &#39;text&#39;, text: `Result: ${JSON.stringify(result)}` }],
        };
    });
}
</code></pre>
<ul>
<li>Registers tools dynamically for discovery via MCP protocol.</li>
<li>Implements error handling to manage invalid tool requests.</li>
<li>Demonstrates modular tool execution for extensibility.</li>
</ul>
<hr>
<h2>Helpful Hints</h2>
<ul>
<li>Examine how Python&#39;s <code class="inline-code">FastMCP</code> simplifies tool registration compared to Java&#39;s Spring Boot annotations.</li>
<li>Observe the use of mock data generation techniques in Python and Java to simulate realistic service responses.</li>
<li>Study TypeScript&#39;s error handling patterns for insights into standardized response construction.</li>
</ul>
<h2>Try This</h2>
<p>Challenge yourself to deepen your understanding:</p>
<ol>
<li><p><strong>Add a New Tool</strong>: Create a new MCP tool in Python or Java that suggests local attractions based on user preferences. Register it in the respective service module.</p>
<ul>
<li>Example: Add a Python tool to <code class="inline-code">itinerary-planning</code> for suggesting nearby landmarks based on hotel location.</li>
</ul>
</li>
<li><p><strong>Trace Tool Discovery</strong>: Use logging to trace how MCP tools are discovered and registered across Python, Java, and TypeScript modules. Observe the differences in implementation.</p>
</li>
<li><p><strong>Enhance Validation Logic</strong>: Modify the validation methods in <code class="inline-code">DestinationService</code> to provide detailed error messages, including examples of valid inputs. This improves user experience and debugging.</p>
</li>
</ol>
<hr>
<p>Excellent work! Continue to the next quest to uncover more mysteries of the <em>Azure Voyager</em>&#39;s systems.</p>
<p>Mission accomplished, Star Voyager‚ÄîPolyglot Service Modules are now fully operational, propelling your cosmic coding skills to warp-speed progress at 60% complete‚Äîkeep blazing through the galaxy! üöÄ‚≠ê‚ö°</p>

</div>


      <div class="quest-navigation quest-navigation-bottom">
        <a href="quest-3.html" class="prev-quest-btn">‚Üê Previous: Quest 3</a>
        <a href="quest-5.html" class="next-quest-btn">Next: Quest 5 ‚Üí</a>
      </div>
    
    </div>
    
    <footer class="footer">
        <div class="footer-content">
            <span>Created using <a href="https://github.com/DanWahlin/ai-repo-adventures" target="_blank" rel="noopener noreferrer" class="repo-link">AI Repo Adventures</a></span>
        </div>
    </footer>
    
    <!-- Quest Navigator Script (for navbar Quests button functionality) -->
    <script src="../assets/shared/quest-navigator.js"></script>
    <!-- Theme Toggle Script (for light/dark mode toggle) -->
    <script src="../assets/theme-toggle.js"></script>
</body>
</html>